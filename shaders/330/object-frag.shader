#version 330

/* mesh buffer
    array structure
     1 -  9: vertices
    10 - 12: face normal
    13 - 15: rgb
    16 - 18: mesh type
*/
uniform int numMeshBuffers;
uniform int maxTrianglesPerBuffer;
uniform samplerBuffer meshBuffer[6];   // assume max 6 buffers
uniform int meshSize; // mesh count

/* tree buffer
     1 -  3: left, right, 0.0f
     4 -  6: min_xyz
     7 -  9: max_xyz
    10 - 15: nodes(only in leaf nodes)
*/
uniform int numTreeBuffers;
uniform int maxNodesPerBuffer;
uniform samplerBuffer treeBuffer[6];   // assume max 6 buffers
uniform int treeSize; // mesh count
uniform int rootIndex;  // index for kdtree root node

uniform int frameCounter;   // incr per frame

uniform vec3 lightPos;  // light position in world space

uniform vec3 meshTrans; // mesh translation

in vec3 pixelColor; // some background calculated by pixel(i, j)
in vec3 rayOrigin;  // camera position
in vec3 rayDirection;   // normalized direction for current ray

const float PI = 3.14159265359;
const int MAX_STACK_SIZE = 1000;

layout(location = 0) out vec4 outColor;
layout(location = 1) out float outDistance;
// out vec4 outputColor;

struct mesh {
    vec3 v1, v2, v3;
    vec3 faceNormal;
    vec3 diffuseColor;
    vec3 type;
};

struct node {
    int left, right;
    vec3 min_xyz;
    vec3 max_xyz;
    int meshes[6];
};

vec2 intersectionAABB(vec3 boxMin, vec3 boxMax, vec3 origin, vec3 direction) {
    float tnear = -1e10;
    float tfar = 1e10;

    // Check each axis
    for (int i = 0; i < 3; i++) {
        if (direction[i] != 0.0) {
            float t1 = (boxMin[i] - origin[i]) / direction[i];
            float t2 = (boxMax[i] - origin[i]) / direction[i];

            if (t1 > t2) {
                float temp = t1;
                t1 = t2;
                t2 = temp;
            }

            tnear = max(tnear, t1);
            tfar = min(tfar, t2);

            if (tnear > tfar || tfar < 0.0) {
                return vec2(-1.0f); // No intersection
            }
        } else {
            // Ray is parallel to the slabs
            if (origin[i] < boxMin[i] || origin[i] > boxMax[i]) {
                return vec2(-1.0f); // Ray misses the box
            }
        }
    }

    return vec2(tnear, tfar);
}

float intersectionTriangle(mesh m, vec3 origin, vec3 direction) {
    vec3 e1 = m.v2 - m.v1;
    vec3 e2 = m.v3 - m.v1;
    vec3 pvec = cross(direction, e2);
    float det = dot(e1, pvec);
    if (abs(det) < 1e-6f) {
        return -1.0f;
    }
    float invDet = 1.0f / det;
    vec3 tvec = origin - m.v1;
    float u = dot(tvec, pvec) * invDet;
    if (u < 0.0f || u > 1.0f) {
        return -1.0f;
    }
    vec3 qvec = cross(tvec, e1);
    float v = dot(direction, qvec) * invDet;
    if (v < 0.0f || u + v > 1.0f) {
        return -1.0f;
    }
    float t = dot(e2, qvec) * invDet;
    if (t > 0.0f) {
        return t;
    }
    return -1.0f;
}

mesh getMesh(int index) {
    int bufferIdx = index / maxTrianglesPerBuffer;
    int localIdx = index % maxTrianglesPerBuffer;
    mesh ret;
    ret.v1 = texelFetch(meshBuffer[bufferIdx], 6 * localIdx).rgb;
    ret.v2 = texelFetch(meshBuffer[bufferIdx], 6 * localIdx + 1).rgb;
    ret.v3 = texelFetch(meshBuffer[bufferIdx], 6 * localIdx + 2).rgb;
    ret.faceNormal = texelFetch(meshBuffer[bufferIdx], 6 * localIdx + 3).rgb;
    ret.diffuseColor = texelFetch(meshBuffer[bufferIdx], 6 * localIdx + 4).rgb;
    ret.type = texelFetch(meshBuffer[bufferIdx], 6 * localIdx + 5).rgb;
    return ret;
}

node getNode(int index) {
    int bufferIdx = index / maxNodesPerBuffer;
    int localIdx = index % maxNodesPerBuffer;
    node ret;
    vec3 v1 = texelFetch(treeBuffer[bufferIdx], 5 * localIdx).rgb;
    ret.left = int(round(v1.x));
    ret.right = int(round(v1.y));
    ret.min_xyz = texelFetch(treeBuffer[bufferIdx], 5 * localIdx + 1).rgb;
    ret.max_xyz = texelFetch(treeBuffer[bufferIdx], 5 * localIdx + 2).rgb;
    vec3 v4 = texelFetch(treeBuffer[bufferIdx], 5 * localIdx + 3).rgb;
    vec3 v5 = texelFetch(treeBuffer[bufferIdx], 5 * localIdx + 4).rgb;
    ret.meshes[0] = int(round(v4.x));
    ret.meshes[1] = int(round(v4.y));
    ret.meshes[2] = int(round(v4.z));
    ret.meshes[3] = int(round(v5.x));
    ret.meshes[4] = int(round(v5.y));
    ret.meshes[5] = int(round(v5.z));
    return ret;
}

vec2 intersection(vec3 origin, vec3 direction) {
    int idx = -1;
    float t = -1.0f;
    for (int i = 0; i < meshSize; i++) {
        mesh m = getMesh(i);
        float tmpt = intersectionTriangle(m, origin, direction);
        if (t < 0.0f) {
            if (tmpt > 0.0f) {
                t = tmpt;
                idx = i;
            }
        }
        else {
            if (tmpt > 0 && tmpt < t) {
                t = tmpt;
                idx = i;
            }
        }
    }
    return vec2(idx, t);
}

vec2 intersectionKDTree(vec3 origin, vec3 direction) {
    // initialize stack with array
    int stack[MAX_STACK_SIZE];
    int stackSize = 0;

    // push root into stack
    stack[stackSize++] = rootIndex;

    int idx = -1;
    float t = -1.0f;

    while (stackSize > 0) {
        // pop top
        int currentIndex = stack[--stackSize];
        node n = getNode(currentIndex);

        if (n.left == -1) { // leaf node
            for (int j = 0; j < 6; j++) {
                if (n.meshes[j] == -1) break; // no more mesh
                mesh m = getMesh(n.meshes[j]);
                float tmpt = intersectionTriangle(m, origin, direction);
                if (t < 0.0f) {
                    if (tmpt > 0.0f) {
                        t = tmpt;
                        idx = n.meshes[j];
                    }
                } else {
                    if (tmpt > 0 && tmpt < t) {
                        t = tmpt;
                        idx = n.meshes[j];
                    }
                }
            }
        } else { // node
            node left = getNode(n.left);
            node right = getNode(n.right);

            if (intersectionAABB(left.min_xyz, left.max_xyz, origin, direction).x >= 0.0f) {
                stack[stackSize++] = n.left; // push left into stack
            }

            if (intersectionAABB(right.min_xyz, right.max_xyz, origin, direction).x >= 0.0f) {
                stack[stackSize++] = n.right; // push right into stack
            }
        }
    }

    return vec2(idx, t);
}

vec4 calculateRGB(vec3 origin, vec3 direction) {
    vec4 color = vec4(0.0f);
    // vec2 ret = intersection(rayOrigin, rayDirection);
    vec2 ret = intersectionKDTree(origin, direction);
    int idx = int(round(ret.x));
    float t = ret.y;
    if (idx < 0) {
        return vec4(0.0f);
    }
    // else {   // only intersection
    //     return vec4(1.0f);
    // }
    mesh m = getMesh(idx);
    vec3 worldPosition = origin + t * direction;
    color = vec4(m.diffuseColor * max(dot(normalize(lightPos - worldPosition), m.faceNormal), 0.0f), 1.0f);
    return color;
}

// sea box
#define sea_bottom -5
#define sea_top -4
#define sea_width 200

// ocean IFFT (simplified simulation)
const int freqCount = 1652;

const vec2 freqDir[1652] = vec2[](
    vec2(0.469155, -0.883116), vec2(0.490261, -0.871576), vec2(0.510539, -0.859855), vec2(0.529999, -0.847998),
    vec2(0.548656, -0.836048), vec2(0.566529, -0.824042), vec2(0.583636, -0.812015), vec2(0.6, -0.8),
    vec2(0.615644, -0.788024), vec2(0.630593, -0.776114), vec2(0.644871, -0.764291), vec2(0.658505, -0.752577),
    vec2(0.671519, -0.740987), vec2(0.683941, -0.729537), vec2(0.695795, -0.71824), vec2(0.458643, -0.888621),
    vec2(0.480833, -0.876812), vec2(0.502136, -0.864789), vec2(0.522562, -0.852601), vec2(0.542127, -0.840297),
    vec2(0.560848, -0.827919), vec2(0.578747, -0.815507), vec2(0.595847, -0.803098), vec2(0.612173, -0.790724),
    vec2(0.627752, -0.778413), vec2(0.642612, -0.766192), vec2(0.656781, -0.754082), vec2(0.670286, -0.742103),
    vec2(0.683157, -0.730271), vec2(0.695421, -0.718602), vec2(0.707107, -0.707107), vec2(0.447214, -0.894427),
    vec2(0.470588, -0.882353), vec2(0.493013, -0.870022), vec2(0.514496, -0.857493), vec2(0.535052, -0.844819),
    vec2(0.5547, -0.83205), vec2(0.573462, -0.819232), vec2(0.591364, -0.806405), vec2(0.608432, -0.793606),
    vec2(0.624695, -0.780869), vec2(0.640184, -0.768221), vec2(0.654931, -0.755689), vec2(0.668965, -0.743294),
    vec2(0.682318, -0.731055), vec2(0.695022, -0.718988), vec2(0.707107, -0.707107), vec2(0.718602, -0.695421),
    vec2(0.434749, -0.900552), vec2(0.459423, -0.888218), vec2(0.483077, -0.875578), vec2(0.505719, -0.862698),
    vec2(0.527363, -0.84964), vec2(0.548026, -0.836461), vec2(0.567733, -0.823213), vec2(0.58651, -0.809942),
    vec2(0.604386, -0.796691), vec2(0.621395, -0.783498), vec2(0.637568, -0.770394), vec2(0.65294, -0.75741),
    vec2(0.667545, -0.744569), vec2(0.681419, -0.731894), vec2(0.694595, -0.719401), vec2(0.707107, -0.707107),
    vec2(0.718988, -0.695022), vec2(0.730271, -0.683157), vec2(0.421111, -0.907009), vec2(0.447214, -0.894427),
    vec2(0.472221, -0.88148), vec2(0.496139, -0.868243), vec2(0.518978, -0.854788), vec2(0.540758, -0.841178),
    vec2(0.561501, -0.827476), vec2(0.581238, -0.813733), vec2(0.6, -0.8), vec2(0.617822, -0.786318),
    vec2(0.634739, -0.772726), vec2(0.650791, -0.759257), vec2(0.666016, -0.745938), vec2(0.680451, -0.732793),
    vec2(0.694136, -0.719844), vec2(0.707107, -0.707107), vec2(0.719401, -0.694595), vec2(0.731055, -0.682318),
    vec2(0.742103, -0.670286), vec2(0.406138, -0.913812), vec2(0.433816, -0.901002), vec2(0.460317, -0.887755),
    vec2(0.485643, -0.874157), vec2(0.509802, -0.860292), vec2(0.532813, -0.846233), vec2(0.5547, -0.83205),
    vec2(0.575493, -0.817806), vec2(0.595228, -0.803557), vec2(0.613941, -0.789352), vec2(0.631673, -0.775235),
    vec2(0.648466, -0.761243), vec2(0.664364, -0.747409), vec2(0.679408, -0.733761), vec2(0.693642, -0.72032),
    vec2(0.707107, -0.707107), vec2(0.719844, -0.694136), vec2(0.731894, -0.681419), vec2(0.743294, -0.668965),
    vec2(0.754082, -0.656781), vec2(0.38964, -0.920967), vec2(0.419058, -0.907959), vec2(0.447214, -0.894427),
    vec2(0.4741, -0.880471), vec2(0.499722, -0.866186), vec2(0.524097, -0.851658), vec2(0.547249, -0.83697),
    vec2(0.56921, -0.822192), vec2(0.590017, -0.807391), vec2(0.609711, -0.792624), vec2(0.628337, -0.777941),
    vec2(0.645942, -0.763386), vec2(0.662574, -0.748997), vec2(0.67828, -0.734803), vec2(0.693109, -0.720833),
    vec2(0.707107, -0.707107), vec2(0.72032, -0.693642), vec2(0.732793, -0.680451), vec2(0.744569, -0.667545),
    vec2(0.755689, -0.654931), vec2(0.766192, -0.642612), vec2(0.402739, -0.915315), vec2(0.432731, -0.901523),
    vec2(0.461353, -0.887217), vec2(0.488603, -0.872506), vec2(0.514496, -0.857493), vec2(0.539054, -0.842271),
    vec2(0.56231, -0.826927), vec2(0.584305, -0.811534), vec2(0.605083, -0.796162), vec2(0.624695, -0.780869),
    vec2(0.643192, -0.765705), vec2(0.660628, -0.750714), vec2(0.677057, -0.735931), vec2(0.692532, -0.721387),
    vec2(0.707107, -0.707107), vec2(0.720833, -0.693109), vec2(0.733761, -0.679408), vec2(0.745938, -0.666016),
    vec2(0.75741, -0.65294), vec2(0.768221, -0.640184), vec2(0.778413, -0.627752), vec2(0.384615, -0.923077),
    vec2(0.416655, -0.909065), vec2(0.447214, -0.894427), vec2(0.476283, -0.879292), vec2(0.503871, -0.863779),
    vec2(0.529999, -0.847998), vec2(0.5547, -0.83205), vec2(0.578017, -0.816024), vec2(0.6, -0.8),
    vec2(0.620703, -0.784046), vec2(0.640184, -0.768221), vec2(0.658505, -0.752577), vec2(0.675725, -0.737154),
    vec2(0.691905, -0.721988), vec2(0.707107, -0.707107), vec2(0.721387, -0.692532), vec2(0.734803, -0.67828),
    vec2(0.747409, -0.664364), vec2(0.759257, -0.650791), vec2(0.770394, -0.637568), vec2(0.780869, -0.624695),
    vec2(0.790724, -0.612173), vec2(0.364399, -0.931243), vec2(0.398726, -0.91707), vec2(0.431455, -0.902134),
    vec2(0.462566, -0.886585), vec2(0.492057, -0.870563), vec2(0.519947, -0.854199), vec2(0.546268, -0.837611),
    vec2(0.571064, -0.820905), vec2(0.594391, -0.804176), vec2(0.616308, -0.787505), vec2(0.636881, -0.770962),
    vec2(0.656179, -0.754606), vec2(0.674269, -0.738485), vec2(0.691223, -0.722642), vec2(0.707107, -0.707107),
    vec2(0.721988, -0.691905), vec2(0.735931, -0.677057), vec2(0.748997, -0.662574), vec2(0.761243, -0.648466),
    vec2(0.772726, -0.634739), vec2(0.783498, -0.621395), vec2(0.793606, -0.608432), vec2(0.803098, -0.595847),
    vec2(0.341743, -0.939793), vec2(0.378633, -0.925547), vec2(0.413803, -0.910366), vec2(0.447214, -0.894427),
    vec2(0.478852, -0.877896), vec2(0.508729, -0.860927), vec2(0.536875, -0.843661), vec2(0.563337, -0.826227),
    vec2(0.588172, -0.808736), vec2(0.611448, -0.791285), vec2(0.633238, -0.773957), vec2(0.65362, -0.756823),
    vec2(0.672673, -0.73994), vec2(0.690476, -0.723356), vec2(0.707107, -0.707107), vec2(0.722642, -0.691223),
    vec2(0.737154, -0.675725), vec2(0.750714, -0.660628), vec2(0.763386, -0.645942), vec2(0.775235, -0.631673),
    vec2(0.786318, -0.617822), vec2(0.796691, -0.604386), vec2(0.806405, -0.591364), vec2(0.815507, -0.578747),
    vec2(0.355995, -0.934488), vec2(0.393919, -0.919145), vec2(0.429934, -0.902861), vec2(0.464007, -0.885832),
    vec2(0.496139, -0.868243), vec2(0.526355, -0.850265), vec2(0.5547, -0.83205), vec2(0.581238, -0.813733),
    vec2(0.606043, -0.795432), vec2(0.629198, -0.777245), vec2(0.650791, -0.759257), vec2(0.670913, -0.741536),
    vec2(0.689655, -0.724138), vec2(0.707107, -0.707107), vec2(0.723356, -0.690476), vec2(0.738485, -0.674269),
    vec2(0.752577, -0.658505), vec2(0.765705, -0.643192), vec2(0.777941, -0.628337), vec2(0.789352, -0.613941),
    vec2(0.8, -0.6), vec2(0.809942, -0.58651), vec2(0.819232, -0.573462), vec2(0.827919, -0.560848),
    vec2(0.33035, -0.943858), vec2(0.371391, -0.928477), vec2(0.410365, -0.911922), vec2(0.447214, -0.894427),
    vec2(0.481919, -0.876216), vec2(0.514496, -0.857493), vec2(0.544988, -0.838444), vec2(0.573462, -0.819232),
    vec2(0.6, -0.8), vec2(0.624695, -0.780869), vec2(0.647648, -0.761939), vec2(0.668965, -0.743294),
    vec2(0.688749, -0.724999), vec2(0.707107, -0.707107), vec2(0.724138, -0.689655), vec2(0.73994, -0.672673),
    vec2(0.754606, -0.656179), vec2(0.768221, -0.640184), vec2(0.780869, -0.624695), vec2(0.792624, -0.609711),
    vec2(0.803557, -0.595228), vec2(0.813733, -0.581238), vec2(0.823213, -0.567733), vec2(0.83205, -0.5547),
    vec2(0.840297, -0.542127), vec2(0.345705, -0.938343), vec2(0.388057, -0.921635), vec2(0.428086, -0.903738),
    vec2(0.465746, -0.884918), vec2(0.501036, -0.865426), vec2(0.533993, -0.845489), vec2(0.564684, -0.825307),
    vec2(0.593199, -0.805056), vec2(0.619644, -0.784883), vec2(0.644136, -0.764911), vec2(0.666795, -0.745241),
    vec2(0.687745, -0.725953), vec2(0.707107, -0.707107), vec2(0.724999, -0.688749), vec2(0.741536, -0.670913),
    vec2(0.756823, -0.65362), vec2(0.770962, -0.636881), vec2(0.784046, -0.620703), vec2(0.796162, -0.605083),
    vec2(0.807391, -0.590017), vec2(0.817806, -0.575493), vec2(0.827476, -0.561501), vec2(0.836461, -0.548026),
    vec2(0.844819, -0.535052), vec2(0.852601, -0.522562), vec2(0.316228, -0.948683), vec2(0.362446, -0.932005),
    vec2(0.406138, -0.913812), vec2(0.447214, -0.894427), vec2(0.485643, -0.874157), vec2(0.52145, -0.853282),
    vec2(0.5547, -0.83205), vec2(0.585491, -0.810679), vec2(0.613941, -0.789352), vec2(0.640184, -0.768221),
    vec2(0.664364, -0.747409), vec2(0.686624, -0.727013), vec2(0.707107, -0.707107), vec2(0.725953, -0.687745),
    vec2(0.743294, -0.668965), vec2(0.759257, -0.650791), vec2(0.773957, -0.633238), vec2(0.787505, -0.616308),
    vec2(0.8, -0.6), vec2(0.811534, -0.584305), vec2(0.822192, -0.56921), vec2(0.83205, -0.5547),
    vec2(0.841178, -0.540758), vec2(0.84964, -0.527363), vec2(0.857493, -0.514496), vec2(0.864789, -0.502136),
    vec2(0.282166, -0.959366), vec2(0.33282, -0.94299), vec2(0.38075, -0.924678), vec2(0.425797, -0.904819),
    vec2(0.467888, -0.883788), vec2(0.50702, -0.861934), vec2(0.543251, -0.83957), vec2(0.576683, -0.816968),
    vec2(0.60745, -0.794358), vec2(0.635707, -0.77193), vec2(0.661622, -0.749838), vec2(0.685365, -0.7282),
    vec2(0.707107, -0.707107), vec2(0.727013, -0.686624), vec2(0.745241, -0.666795), vec2(0.761939, -0.647648),
    vec2(0.777245, -0.629198), vec2(0.791285, -0.611448), vec2(0.804176, -0.594391), vec2(0.816024, -0.578017),
    vec2(0.826927, -0.56231), vec2(0.83697, -0.547249), vec2(0.846233, -0.532813), vec2(0.854788, -0.518978),
    vec2(0.862698, -0.505719), vec2(0.870022, -0.493013), vec2(0.876812, -0.480833), vec2(0.298275, -0.95448),
    vec2(0.351123, -0.936329), vec2(0.400819, -0.916157), vec2(0.447214, -0.894427), vec2(0.490261, -0.871576),
    vec2(0.529999, -0.847998), vec2(0.566529, -0.824042), vec2(0.6, -0.8), vec2(0.630593, -0.776114),
    vec2(0.658505, -0.752577), vec2(0.683941, -0.729537), vec2(0.707107, -0.707107), vec2(0.7282, -0.685365),
    vec2(0.747409, -0.664364), vec2(0.764911, -0.644136), vec2(0.780869, -0.624695), vec2(0.795432, -0.606043),
    vec2(0.808736, -0.588172), vec2(0.820905, -0.571064), vec2(0.83205, -0.5547), vec2(0.842271, -0.539054),
    vec2(0.851658, -0.524097), vec2(0.860292, -0.509802), vec2(0.868243, -0.496139), vec2(0.875578, -0.483077),
    vec2(0.882353, -0.470588), vec2(0.888621, -0.458643), vec2(0.257663, -0.966235), vec2(0.316228, -0.948683),
    vec2(0.371391, -0.928477), vec2(0.422885, -0.906183), vec2(0.470588, -0.882353), vec2(0.514496, -0.857493),
    vec2(0.5547, -0.83205), vec2(0.591364, -0.806405), vec2(0.624695, -0.780869), vec2(0.654931, -0.755689),
    vec2(0.682318, -0.731055), vec2(0.707107, -0.707107), vec2(0.729537, -0.683941), vec2(0.749838, -0.661622),
    vec2(0.768221, -0.640184), vec2(0.784883, -0.619644), vec2(0.8, -0.6), vec2(0.813733, -0.581238),
    vec2(0.826227, -0.563337), vec2(0.837611, -0.546268), vec2(0.847998, -0.529999), vec2(0.857493, -0.514496),
    vec2(0.866186, -0.499722), vec2(0.874157, -0.485643), vec2(0.88148, -0.472221), vec2(0.888218, -0.459423),
    vec2(0.894427, -0.447214), vec2(0.900159, -0.435561), vec2(0.274721, -0.961524), vec2(0.336336, -0.941742),
    vec2(0.393919, -0.919145), vec2(0.447214, -0.894427), vec2(0.496139, -0.868243), vec2(0.540758, -0.841178),
    vec2(0.581238, -0.813733), vec2(0.617822, -0.786318), vec2(0.650791, -0.759257), vec2(0.680451, -0.732793),
    vec2(0.707107, -0.707107), vec2(0.731055, -0.682318), vec2(0.752577, -0.658505), vec2(0.77193, -0.635707),
    vec2(0.789352, -0.613941), vec2(0.805056, -0.593199), vec2(0.819232, -0.573462), vec2(0.83205, -0.5547),
    vec2(0.843661, -0.536875), vec2(0.854199, -0.519947), vec2(0.863779, -0.503871), vec2(0.872506, -0.488603),
    vec2(0.880471, -0.4741), vec2(0.887755, -0.460317), vec2(0.894427, -0.447214), vec2(0.900552, -0.434749),
    vec2(0.906183, -0.422885), vec2(0.911371, -0.411587), vec2(0.294086, -0.955779), vec2(0.358979, -0.933346),
    vec2(0.419058, -0.907959), vec2(0.4741, -0.880471), vec2(0.524097, -0.851658), vec2(0.56921, -0.822192),
    vec2(0.609711, -0.792624), vec2(0.645942, -0.763386), vec2(0.67828, -0.734803), vec2(0.707107, -0.707107),
    vec2(0.732793, -0.680451), vec2(0.755689, -0.654931), vec2(0.776114, -0.630593), vec2(0.794358, -0.60745),
    vec2(0.810679, -0.585491), vec2(0.825307, -0.564684), vec2(0.838444, -0.544988), vec2(0.850265, -0.526355),
    vec2(0.860927, -0.508729), vec2(0.870563, -0.492057), vec2(0.879292, -0.476283), vec2(0.887217, -0.461353),
    vec2(0.894427, -0.447214), vec2(0.901002, -0.433816), vec2(0.907009, -0.421111), vec2(0.912509, -0.409056),
    vec2(0.917556, -0.397607), vec2(0.922194, -0.386727), vec2(0.242536, -0.970143), vec2(0.316228, -0.948683),
    vec2(0.384615, -0.923077), vec2(0.447214, -0.894427), vec2(0.503871, -0.863779), vec2(0.5547, -0.83205),
    vec2(0.6, -0.8), vec2(0.640184, -0.768221), vec2(0.675725, -0.737154), vec2(0.707107, -0.707107),
    vec2(0.734803, -0.67828), vec2(0.759257, -0.650791), vec2(0.780869, -0.624695), vec2(0.8, -0.6),
    vec2(0.816968, -0.576683), vec2(0.83205, -0.5547), vec2(0.845489, -0.533993), vec2(0.857493, -0.514496),
    vec2(0.868243, -0.496139), vec2(0.877896, -0.478852), vec2(0.886585, -0.462566), vec2(0.894427, -0.447214),
    vec2(0.901523, -0.432731), vec2(0.907959, -0.419058), vec2(0.913812, -0.406138), vec2(0.919145, -0.393919),
    vec2(0.924017, -0.382352), vec2(0.928477, -0.371391), vec2(0.932568, -0.360994), vec2(0.263117, -0.964764),
    vec2(0.341743, -0.939793), vec2(0.413803, -0.910366), vec2(0.478852, -0.877896), vec2(0.536875, -0.843661),
    vec2(0.588172, -0.808736), vec2(0.633238, -0.773957), vec2(0.672673, -0.73994), vec2(0.707107, -0.707107),
    vec2(0.737154, -0.675725), vec2(0.763386, -0.645942), vec2(0.786318, -0.617822), vec2(0.806405, -0.591364),
    vec2(0.824042, -0.566529), vec2(0.83957, -0.543251), vec2(0.853282, -0.52145), vec2(0.865426, -0.501036),
    vec2(0.876216, -0.481919), vec2(0.885832, -0.464007), vec2(0.894427, -0.447214), vec2(0.902134, -0.431455),
    vec2(0.909065, -0.416655), vec2(0.915315, -0.402739), vec2(0.920967, -0.38964), vec2(0.926092, -0.377297),
    vec2(0.930751, -0.365652), vec2(0.934998, -0.354654), vec2(0.938876, -0.344255), vec2(0.942428, -0.33441),
    vec2(0.196116, -0.980581), vec2(0.287348, -0.957826), vec2(0.371391, -0.928477), vec2(0.447214, -0.894427),
    vec2(0.514496, -0.857493), vec2(0.573462, -0.819232), vec2(0.624695, -0.780869), vec2(0.668965, -0.743294),
    vec2(0.707107, -0.707107), vec2(0.73994, -0.672673), vec2(0.768221, -0.640184), vec2(0.792624, -0.609711),
    vec2(0.813733, -0.581238), vec2(0.83205, -0.5547), vec2(0.847998, -0.529999), vec2(0.861934, -0.50702),
    vec2(0.874157, -0.485643), vec2(0.884918, -0.465746), vec2(0.894427, -0.447214), vec2(0.902861, -0.429934),
    vec2(0.910366, -0.413803), vec2(0.91707, -0.398726), vec2(0.923077, -0.384615), vec2(0.928477, -0.371391),
    vec2(0.933346, -0.358979), vec2(0.937749, -0.347314), vec2(0.941742, -0.336336), vec2(0.945373, -0.325991),
    vec2(0.948683, -0.316228), vec2(0.951709, -0.307003), vec2(0.21693, -0.976187), vec2(0.316228, -0.948683),
    vec2(0.406138, -0.913812), vec2(0.485643, -0.874157), vec2(0.5547, -0.83205), vec2(0.613941, -0.789352),
    vec2(0.664364, -0.747409), vec2(0.707107, -0.707107), vec2(0.743294, -0.668965), vec2(0.773957, -0.633238),
    vec2(0.8, -0.6), vec2(0.822192, -0.56921), vec2(0.841178, -0.540758), vec2(0.857493, -0.514496),
    vec2(0.871576, -0.490261), vec2(0.883788, -0.467888), vec2(0.894427, -0.447214), vec2(0.903738, -0.428086),
    vec2(0.911922, -0.410365), vec2(0.919145, -0.393919), vec2(0.925547, -0.378633), vec2(0.931243, -0.364399),
    vec2(0.936329, -0.351123), vec2(0.940887, -0.338719), vec2(0.944986, -0.327111), vec2(0.948683, -0.316228),
    vec2(0.952029, -0.306009), vec2(0.955064, -0.296399), vec2(0.957826, -0.287348), vec2(0.960346, -0.27881),
    vec2(0.242536, -0.970143), vec2(0.351123, -0.936329), vec2(0.447214, -0.894427), vec2(0.529999, -0.847998),
    vec2(0.6, -0.8), vec2(0.658505, -0.752577), vec2(0.707107, -0.707107), vec2(0.747409, -0.664364),
    vec2(0.780869, -0.624695), vec2(0.808736, -0.588172), vec2(0.83205, -0.5547), vec2(0.851658, -0.524097),
    vec2(0.868243, -0.496139), vec2(0.882353, -0.470588), vec2(0.894427, -0.447214), vec2(0.904819, -0.425797),
    vec2(0.913812, -0.406138), vec2(0.921635, -0.388057), vec2(0.928477, -0.371391), vec2(0.934488, -0.355995),
    vec2(0.939793, -0.341743), vec2(0.944497, -0.328521), vec2(0.948683, -0.316228), vec2(0.952424, -0.304776),
    vec2(0.955779, -0.294086), vec2(0.958798, -0.284088), vec2(0.961524, -0.274721), vec2(0.963993, -0.265929),
    vec2(0.966235, -0.257663), vec2(0.968277, -0.249878), vec2(0.274721, -0.961524), vec2(0.393919, -0.919145),
    vec2(0.496139, -0.868243), vec2(0.581238, -0.813733), vec2(0.650791, -0.759257), vec2(0.707107, -0.707107),
    vec2(0.752577, -0.658505), vec2(0.789352, -0.613941), vec2(0.819232, -0.573462), vec2(0.843661, -0.536875),
    vec2(0.863779, -0.503871), vec2(0.880471, -0.4741), vec2(0.894427, -0.447214), vec2(0.906183, -0.422885),
    vec2(0.916157, -0.400819), vec2(0.924678, -0.38075), vec2(0.932005, -0.362446), vec2(0.938343, -0.345705),
    vec2(0.943858, -0.33035), vec2(0.948683, -0.316228), vec2(0.952926, -0.303204), vec2(0.956674, -0.291162),
    vec2(0.96, -0.28), vec2(0.962964, -0.26963), vec2(0.965616, -0.259973), vec2(0.967997, -0.250962),
    vec2(0.970143, -0.242536), vec2(0.972082, -0.234641), vec2(0.973841, -0.22723), vec2(0.975441, -0.220261),
    vec2(0.164399, -0.986394), vec2(0.316228, -0.948683), vec2(0.447214, -0.894427), vec2(0.5547, -0.83205),
    vec2(0.640184, -0.768221), vec2(0.707107, -0.707107), vec2(0.759257, -0.650791), vec2(0.8, -0.6),
    vec2(0.83205, -0.5547), vec2(0.857493, -0.514496), vec2(0.877896, -0.478852), vec2(0.894427, -0.447214),
    vec2(0.907959, -0.419058), vec2(0.919145, -0.393919), vec2(0.928477, -0.371391), vec2(0.936329, -0.351123),
    vec2(0.94299, -0.33282), vec2(0.948683, -0.316228), vec2(0.953583, -0.301131), vec2(0.957826, -0.287348),
    vec2(0.961524, -0.274721), vec2(0.964764, -0.263117), vec2(0.967617, -0.252422), vec2(0.970143, -0.242536),
    vec2(0.972387, -0.233373), vec2(0.974391, -0.22486), vec2(0.976187, -0.21693), vec2(0.977802, -0.209529),
    vec2(0.97926, -0.202606), vec2(0.980581, -0.196116), vec2(0.98178, -0.190022), vec2(0.196116, -0.980581),
    vec2(0.371391, -0.928477), vec2(0.514496, -0.857493), vec2(0.624695, -0.780869), vec2(0.707107, -0.707107),
    vec2(0.768221, -0.640184), vec2(0.813733, -0.581238), vec2(0.847998, -0.529999), vec2(0.874157, -0.485643),
    vec2(0.894427, -0.447214), vec2(0.910366, -0.413803), vec2(0.923077, -0.384615), vec2(0.933346, -0.358979),
    vec2(0.941742, -0.336336), vec2(0.948683, -0.316228), vec2(0.95448, -0.298275), vec2(0.959366, -0.282166),
    vec2(0.963518, -0.267644), vec2(0.967075, -0.254493), vec2(0.970143, -0.242536), vec2(0.972806, -0.231621),
    vec2(0.975133, -0.221621), vec2(0.977176, -0.21243), vec2(0.97898, -0.203954), vec2(0.980581, -0.196116),
    vec2(0.982006, -0.188847), vec2(0.983282, -0.182089), vec2(0.984428, -0.175791), vec2(0.98546, -0.169907),
    vec2(0.986394, -0.164399), vec2(0.987241, -0.159232), vec2(0.242536, -0.970143), vec2(0.447214, -0.894427),
    vec2(0.6, -0.8), vec2(0.707107, -0.707107), vec2(0.780869, -0.624695), vec2(0.83205, -0.5547),
    vec2(0.868243, -0.496139), vec2(0.894427, -0.447214), vec2(0.913812, -0.406138), vec2(0.928477, -0.371391),
    vec2(0.939793, -0.341743), vec2(0.948683, -0.316228), vec2(0.955779, -0.294086), vec2(0.961524, -0.274721),
    vec2(0.966235, -0.257663), vec2(0.970143, -0.242536), vec2(0.973417, -0.229039), vec2(0.976187, -0.21693),
    vec2(0.97855, -0.20601), vec2(0.980581, -0.196116), vec2(0.982339, -0.187112), vec2(0.98387, -0.178885),
    vec2(0.985212, -0.171341), vec2(0.986394, -0.164399), vec2(0.987441, -0.157991), vec2(0.988372, -0.152057),
    vec2(0.989203, -0.146549), vec2(0.989949, -0.141421), vec2(0.990621, -0.136637), vec2(0.991228, -0.132164),
    vec2(0.991778, -0.127971), vec2(0.316228, -0.948683), vec2(0.5547, -0.83205), vec2(0.707107, -0.707107),
    vec2(0.8, -0.6), vec2(0.857493, -0.514496), vec2(0.894427, -0.447214), vec2(0.919145, -0.393919),
    vec2(0.936329, -0.351123), vec2(0.948683, -0.316228), vec2(0.957826, -0.287348), vec2(0.964764, -0.263117),
    vec2(0.970143, -0.242536), vec2(0.974391, -0.22486), vec2(0.977802, -0.209529), vec2(0.980581, -0.196116),
    vec2(0.982872, -0.184289), vec2(0.984784, -0.173785), vec2(0.986394, -0.164399), vec2(0.987763, -0.155963),
    vec2(0.988936, -0.14834), vec2(0.989949, -0.141421), vec2(0.99083, -0.135113), vec2(0.9916, -0.129339),
    vec2(0.992278, -0.124035), vec2(0.992877, -0.119145), vec2(0.993409, -0.114624), vec2(0.993884, -0.110432),
    vec2(0.994309, -0.106533), vec2(0.994692, -0.102899), vec2(0.995037, -0.099504), vec2(0.99535, -0.096324),
    vec2(0.447214, -0.894427), vec2(0.707107, -0.707107), vec2(0.83205, -0.5547), vec2(0.894427, -0.447214),
    vec2(0.928477, -0.371391), vec2(0.948683, -0.316228), vec2(0.961524, -0.274721), vec2(0.970143, -0.242536),
    vec2(0.976187, -0.21693), vec2(0.980581, -0.196116), vec2(0.98387, -0.178885), vec2(0.986394, -0.164399),
    vec2(0.988372, -0.152057), vec2(0.989949, -0.141421), vec2(0.991228, -0.132164), vec2(0.992278, -0.124035),
    vec2(0.993151, -0.116841), vec2(0.993884, -0.110432), vec2(0.994505, -0.104685), vec2(0.995037, -0.099504),
    vec2(0.995495, -0.094809), vec2(0.995893, -0.090536), vec2(0.996241, -0.08663), vec2(0.996546, -0.083045),
    vec2(0.996815, -0.079745), vec2(0.997054, -0.076696), vec2(0.997268, -0.073872), vec2(0.997459, -0.071247),
    vec2(0.99763, -0.068802), vec2(0.997785, -0.066519), vec2(0.997925, -0.064382), vec2(0.707107, -0.707107),
    vec2(0.894427, -0.447214), vec2(0.948683, -0.316228), vec2(0.970143, -0.242536), vec2(0.980581, -0.196116),
    vec2(0.986394, -0.164399), vec2(0.989949, -0.141421), vec2(0.992278, -0.124035), vec2(0.993884, -0.110432),
    vec2(0.995037, -0.099504), vec2(0.995893, -0.090536), vec2(0.996546, -0.083045), vec2(0.997054, -0.076696),
    vec2(0.997459, -0.071247), vec2(0.997785, -0.066519), vec2(0.998053, -0.062378), vec2(0.998274, -0.058722),
    vec2(0.99846, -0.05547), vec2(0.998618, -0.052559), vec2(0.998752, -0.049938), vec2(0.998868, -0.047565),
    vec2(0.998969, -0.045408), vec2(0.999056, -0.043437), vec2(0.999133, -0.041631), vec2(0.999201, -0.039968),
    vec2(0.999261, -0.038433), vec2(0.999315, -0.037012), vec2(0.999363, -0.035692), vec2(0.999406, -0.034462),
    vec2(0.999445, -0.033315), vec2(0.99948, -0.032241), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0), vec2(1.0, 0.0),
    vec2(1.0, 0.0), vec2(0.707107, 0.707107), vec2(0.894427, 0.447214), vec2(0.948683, 0.316228),
    vec2(0.970143, 0.242536), vec2(0.980581, 0.196116), vec2(0.986394, 0.164399), vec2(0.989949, 0.141421),
    vec2(0.992278, 0.124035), vec2(0.993884, 0.110432), vec2(0.995037, 0.099504), vec2(0.995893, 0.090536),
    vec2(0.996546, 0.083045), vec2(0.997054, 0.076696), vec2(0.997459, 0.071247), vec2(0.997785, 0.066519),
    vec2(0.998053, 0.062378), vec2(0.998274, 0.058722), vec2(0.99846, 0.05547), vec2(0.998618, 0.052559),
    vec2(0.998752, 0.049938), vec2(0.998868, 0.047565), vec2(0.998969, 0.045408), vec2(0.999056, 0.043437),
    vec2(0.999133, 0.041631), vec2(0.999201, 0.039968), vec2(0.999261, 0.038433), vec2(0.999315, 0.037012),
    vec2(0.999363, 0.035692), vec2(0.999406, 0.034462), vec2(0.999445, 0.033315), vec2(0.99948, 0.032241),
    vec2(0.447214, 0.894427), vec2(0.707107, 0.707107), vec2(0.83205, 0.5547), vec2(0.894427, 0.447214),
    vec2(0.928477, 0.371391), vec2(0.948683, 0.316228), vec2(0.961524, 0.274721), vec2(0.970143, 0.242536),
    vec2(0.976187, 0.21693), vec2(0.980581, 0.196116), vec2(0.98387, 0.178885), vec2(0.986394, 0.164399),
    vec2(0.988372, 0.152057), vec2(0.989949, 0.141421), vec2(0.991228, 0.132164), vec2(0.992278, 0.124035),
    vec2(0.993151, 0.116841), vec2(0.993884, 0.110432), vec2(0.994505, 0.104685), vec2(0.995037, 0.099504),
    vec2(0.995495, 0.094809), vec2(0.995893, 0.090536), vec2(0.996241, 0.08663), vec2(0.996546, 0.083045),
    vec2(0.996815, 0.079745), vec2(0.997054, 0.076696), vec2(0.997268, 0.073872), vec2(0.997459, 0.071247),
    vec2(0.99763, 0.068802), vec2(0.997785, 0.066519), vec2(0.997925, 0.064382), vec2(0.316228, 0.948683),
    vec2(0.5547, 0.83205), vec2(0.707107, 0.707107), vec2(0.8, 0.6), vec2(0.857493, 0.514496),
    vec2(0.894427, 0.447214), vec2(0.919145, 0.393919), vec2(0.936329, 0.351123), vec2(0.948683, 0.316228),
    vec2(0.957826, 0.287348), vec2(0.964764, 0.263117), vec2(0.970143, 0.242536), vec2(0.974391, 0.22486),
    vec2(0.977802, 0.209529), vec2(0.980581, 0.196116), vec2(0.982872, 0.184289), vec2(0.984784, 0.173785),
    vec2(0.986394, 0.164399), vec2(0.987763, 0.155963), vec2(0.988936, 0.14834), vec2(0.989949, 0.141421),
    vec2(0.99083, 0.135113), vec2(0.9916, 0.129339), vec2(0.992278, 0.124035), vec2(0.992877, 0.119145),
    vec2(0.993409, 0.114624), vec2(0.993884, 0.110432), vec2(0.994309, 0.106533), vec2(0.994692, 0.102899),
    vec2(0.995037, 0.099504), vec2(0.99535, 0.096324), vec2(0.242536, 0.970143), vec2(0.447214, 0.894427),
    vec2(0.6, 0.8), vec2(0.707107, 0.707107), vec2(0.780869, 0.624695), vec2(0.83205, 0.5547),
    vec2(0.868243, 0.496139), vec2(0.894427, 0.447214), vec2(0.913812, 0.406138), vec2(0.928477, 0.371391),
    vec2(0.939793, 0.341743), vec2(0.948683, 0.316228), vec2(0.955779, 0.294086), vec2(0.961524, 0.274721),
    vec2(0.966235, 0.257663), vec2(0.970143, 0.242536), vec2(0.973417, 0.229039), vec2(0.976187, 0.21693),
    vec2(0.97855, 0.20601), vec2(0.980581, 0.196116), vec2(0.982339, 0.187112), vec2(0.98387, 0.178885),
    vec2(0.985212, 0.171341), vec2(0.986394, 0.164399), vec2(0.987441, 0.157991), vec2(0.988372, 0.152057),
    vec2(0.989203, 0.146549), vec2(0.989949, 0.141421), vec2(0.990621, 0.136637), vec2(0.991228, 0.132164),
    vec2(0.991778, 0.127971), vec2(0.196116, 0.980581), vec2(0.371391, 0.928477), vec2(0.514496, 0.857493),
    vec2(0.624695, 0.780869), vec2(0.707107, 0.707107), vec2(0.768221, 0.640184), vec2(0.813733, 0.581238),
    vec2(0.847998, 0.529999), vec2(0.874157, 0.485643), vec2(0.894427, 0.447214), vec2(0.910366, 0.413803),
    vec2(0.923077, 0.384615), vec2(0.933346, 0.358979), vec2(0.941742, 0.336336), vec2(0.948683, 0.316228),
    vec2(0.95448, 0.298275), vec2(0.959366, 0.282166), vec2(0.963518, 0.267644), vec2(0.967075, 0.254493),
    vec2(0.970143, 0.242536), vec2(0.972806, 0.231621), vec2(0.975133, 0.221621), vec2(0.977176, 0.21243),
    vec2(0.97898, 0.203954), vec2(0.980581, 0.196116), vec2(0.982006, 0.188847), vec2(0.983282, 0.182089),
    vec2(0.984428, 0.175791), vec2(0.98546, 0.169907), vec2(0.986394, 0.164399), vec2(0.987241, 0.159232),
    vec2(0.164399, 0.986394), vec2(0.316228, 0.948683), vec2(0.447214, 0.894427), vec2(0.5547, 0.83205),
    vec2(0.640184, 0.768221), vec2(0.707107, 0.707107), vec2(0.759257, 0.650791), vec2(0.8, 0.6),
    vec2(0.83205, 0.5547), vec2(0.857493, 0.514496), vec2(0.877896, 0.478852), vec2(0.894427, 0.447214),
    vec2(0.907959, 0.419058), vec2(0.919145, 0.393919), vec2(0.928477, 0.371391), vec2(0.936329, 0.351123),
    vec2(0.94299, 0.33282), vec2(0.948683, 0.316228), vec2(0.953583, 0.301131), vec2(0.957826, 0.287348),
    vec2(0.961524, 0.274721), vec2(0.964764, 0.263117), vec2(0.967617, 0.252422), vec2(0.970143, 0.242536),
    vec2(0.972387, 0.233373), vec2(0.974391, 0.22486), vec2(0.976187, 0.21693), vec2(0.977802, 0.209529),
    vec2(0.97926, 0.202606), vec2(0.980581, 0.196116), vec2(0.98178, 0.190022), vec2(0.274721, 0.961524),
    vec2(0.393919, 0.919145), vec2(0.496139, 0.868243), vec2(0.581238, 0.813733), vec2(0.650791, 0.759257),
    vec2(0.707107, 0.707107), vec2(0.752577, 0.658505), vec2(0.789352, 0.613941), vec2(0.819232, 0.573462),
    vec2(0.843661, 0.536875), vec2(0.863779, 0.503871), vec2(0.880471, 0.4741), vec2(0.894427, 0.447214),
    vec2(0.906183, 0.422885), vec2(0.916157, 0.400819), vec2(0.924678, 0.38075), vec2(0.932005, 0.362446),
    vec2(0.938343, 0.345705), vec2(0.943858, 0.33035), vec2(0.948683, 0.316228), vec2(0.952926, 0.303204),
    vec2(0.956674, 0.291162), vec2(0.96, 0.28), vec2(0.962964, 0.26963), vec2(0.965616, 0.259973),
    vec2(0.967997, 0.250962), vec2(0.970143, 0.242536), vec2(0.972082, 0.234641), vec2(0.973841, 0.22723),
    vec2(0.975441, 0.220261), vec2(0.242536, 0.970143), vec2(0.351123, 0.936329), vec2(0.447214, 0.894427),
    vec2(0.529999, 0.847998), vec2(0.6, 0.8), vec2(0.658505, 0.752577), vec2(0.707107, 0.707107),
    vec2(0.747409, 0.664364), vec2(0.780869, 0.624695), vec2(0.808736, 0.588172), vec2(0.83205, 0.5547),
    vec2(0.851658, 0.524097), vec2(0.868243, 0.496139), vec2(0.882353, 0.470588), vec2(0.894427, 0.447214),
    vec2(0.904819, 0.425797), vec2(0.913812, 0.406138), vec2(0.921635, 0.388057), vec2(0.928477, 0.371391),
    vec2(0.934488, 0.355995), vec2(0.939793, 0.341743), vec2(0.944497, 0.328521), vec2(0.948683, 0.316228),
    vec2(0.952424, 0.304776), vec2(0.955779, 0.294086), vec2(0.958798, 0.284088), vec2(0.961524, 0.274721),
    vec2(0.963993, 0.265929), vec2(0.966235, 0.257663), vec2(0.968277, 0.249878), vec2(0.21693, 0.976187),
    vec2(0.316228, 0.948683), vec2(0.406138, 0.913812), vec2(0.485643, 0.874157), vec2(0.5547, 0.83205),
    vec2(0.613941, 0.789352), vec2(0.664364, 0.747409), vec2(0.707107, 0.707107), vec2(0.743294, 0.668965),
    vec2(0.773957, 0.633238), vec2(0.8, 0.6), vec2(0.822192, 0.56921), vec2(0.841178, 0.540758),
    vec2(0.857493, 0.514496), vec2(0.871576, 0.490261), vec2(0.883788, 0.467888), vec2(0.894427, 0.447214),
    vec2(0.903738, 0.428086), vec2(0.911922, 0.410365), vec2(0.919145, 0.393919), vec2(0.925547, 0.378633),
    vec2(0.931243, 0.364399), vec2(0.936329, 0.351123), vec2(0.940887, 0.338719), vec2(0.944986, 0.327111),
    vec2(0.948683, 0.316228), vec2(0.952029, 0.306009), vec2(0.955064, 0.296399), vec2(0.957826, 0.287348),
    vec2(0.960346, 0.27881), vec2(0.196116, 0.980581), vec2(0.287348, 0.957826), vec2(0.371391, 0.928477),
    vec2(0.447214, 0.894427), vec2(0.514496, 0.857493), vec2(0.573462, 0.819232), vec2(0.624695, 0.780869),
    vec2(0.668965, 0.743294), vec2(0.707107, 0.707107), vec2(0.73994, 0.672673), vec2(0.768221, 0.640184),
    vec2(0.792624, 0.609711), vec2(0.813733, 0.581238), vec2(0.83205, 0.5547), vec2(0.847998, 0.529999),
    vec2(0.861934, 0.50702), vec2(0.874157, 0.485643), vec2(0.884918, 0.465746), vec2(0.894427, 0.447214),
    vec2(0.902861, 0.429934), vec2(0.910366, 0.413803), vec2(0.91707, 0.398726), vec2(0.923077, 0.384615),
    vec2(0.928477, 0.371391), vec2(0.933346, 0.358979), vec2(0.937749, 0.347314), vec2(0.941742, 0.336336),
    vec2(0.945373, 0.325991), vec2(0.948683, 0.316228), vec2(0.951709, 0.307003), vec2(0.263117, 0.964764),
    vec2(0.341743, 0.939793), vec2(0.413803, 0.910366), vec2(0.478852, 0.877896), vec2(0.536875, 0.843661),
    vec2(0.588172, 0.808736), vec2(0.633238, 0.773957), vec2(0.672673, 0.73994), vec2(0.707107, 0.707107),
    vec2(0.737154, 0.675725), vec2(0.763386, 0.645942), vec2(0.786318, 0.617822), vec2(0.806405, 0.591364),
    vec2(0.824042, 0.566529), vec2(0.83957, 0.543251), vec2(0.853282, 0.52145), vec2(0.865426, 0.501036),
    vec2(0.876216, 0.481919), vec2(0.885832, 0.464007), vec2(0.894427, 0.447214), vec2(0.902134, 0.431455),
    vec2(0.909065, 0.416655), vec2(0.915315, 0.402739), vec2(0.920967, 0.38964), vec2(0.926092, 0.377297),
    vec2(0.930751, 0.365652), vec2(0.934998, 0.354654), vec2(0.938876, 0.344255), vec2(0.942428, 0.33441),
    vec2(0.242536, 0.970143), vec2(0.316228, 0.948683), vec2(0.384615, 0.923077), vec2(0.447214, 0.894427),
    vec2(0.503871, 0.863779), vec2(0.5547, 0.83205), vec2(0.6, 0.8), vec2(0.640184, 0.768221),
    vec2(0.675725, 0.737154), vec2(0.707107, 0.707107), vec2(0.734803, 0.67828), vec2(0.759257, 0.650791),
    vec2(0.780869, 0.624695), vec2(0.8, 0.6), vec2(0.816968, 0.576683), vec2(0.83205, 0.5547),
    vec2(0.845489, 0.533993), vec2(0.857493, 0.514496), vec2(0.868243, 0.496139), vec2(0.877896, 0.478852),
    vec2(0.886585, 0.462566), vec2(0.894427, 0.447214), vec2(0.901523, 0.432731), vec2(0.907959, 0.419058),
    vec2(0.913812, 0.406138), vec2(0.919145, 0.393919), vec2(0.924017, 0.382352), vec2(0.928477, 0.371391),
    vec2(0.932568, 0.360994), vec2(0.294086, 0.955779), vec2(0.358979, 0.933346), vec2(0.419058, 0.907959),
    vec2(0.4741, 0.880471), vec2(0.524097, 0.851658), vec2(0.56921, 0.822192), vec2(0.609711, 0.792624),
    vec2(0.645942, 0.763386), vec2(0.67828, 0.734803), vec2(0.707107, 0.707107), vec2(0.732793, 0.680451),
    vec2(0.755689, 0.654931), vec2(0.776114, 0.630593), vec2(0.794358, 0.60745), vec2(0.810679, 0.585491),
    vec2(0.825307, 0.564684), vec2(0.838444, 0.544988), vec2(0.850265, 0.526355), vec2(0.860927, 0.508729),
    vec2(0.870563, 0.492057), vec2(0.879292, 0.476283), vec2(0.887217, 0.461353), vec2(0.894427, 0.447214),
    vec2(0.901002, 0.433816), vec2(0.907009, 0.421111), vec2(0.912509, 0.409056), vec2(0.917556, 0.397607),
    vec2(0.922194, 0.386727), vec2(0.274721, 0.961524), vec2(0.336336, 0.941742), vec2(0.393919, 0.919145),
    vec2(0.447214, 0.894427), vec2(0.496139, 0.868243), vec2(0.540758, 0.841178), vec2(0.581238, 0.813733),
    vec2(0.617822, 0.786318), vec2(0.650791, 0.759257), vec2(0.680451, 0.732793), vec2(0.707107, 0.707107),
    vec2(0.731055, 0.682318), vec2(0.752577, 0.658505), vec2(0.77193, 0.635707), vec2(0.789352, 0.613941),
    vec2(0.805056, 0.593199), vec2(0.819232, 0.573462), vec2(0.83205, 0.5547), vec2(0.843661, 0.536875),
    vec2(0.854199, 0.519947), vec2(0.863779, 0.503871), vec2(0.872506, 0.488603), vec2(0.880471, 0.4741),
    vec2(0.887755, 0.460317), vec2(0.894427, 0.447214), vec2(0.900552, 0.434749), vec2(0.906183, 0.422885),
    vec2(0.911371, 0.411587), vec2(0.257663, 0.966235), vec2(0.316228, 0.948683), vec2(0.371391, 0.928477),
    vec2(0.422885, 0.906183), vec2(0.470588, 0.882353), vec2(0.514496, 0.857493), vec2(0.5547, 0.83205),
    vec2(0.591364, 0.806405), vec2(0.624695, 0.780869), vec2(0.654931, 0.755689), vec2(0.682318, 0.731055),
    vec2(0.707107, 0.707107), vec2(0.729537, 0.683941), vec2(0.749838, 0.661622), vec2(0.768221, 0.640184),
    vec2(0.784883, 0.619644), vec2(0.8, 0.6), vec2(0.813733, 0.581238), vec2(0.826227, 0.563337),
    vec2(0.837611, 0.546268), vec2(0.847998, 0.529999), vec2(0.857493, 0.514496), vec2(0.866186, 0.499722),
    vec2(0.874157, 0.485643), vec2(0.88148, 0.472221), vec2(0.888218, 0.459423), vec2(0.894427, 0.447214),
    vec2(0.900159, 0.435561), vec2(0.298275, 0.95448), vec2(0.351123, 0.936329), vec2(0.400819, 0.916157),
    vec2(0.447214, 0.894427), vec2(0.490261, 0.871576), vec2(0.529999, 0.847998), vec2(0.566529, 0.824042),
    vec2(0.6, 0.8), vec2(0.630593, 0.776114), vec2(0.658505, 0.752577), vec2(0.683941, 0.729537),
    vec2(0.707107, 0.707107), vec2(0.7282, 0.685365), vec2(0.747409, 0.664364), vec2(0.764911, 0.644136),
    vec2(0.780869, 0.624695), vec2(0.795432, 0.606043), vec2(0.808736, 0.588172), vec2(0.820905, 0.571064),
    vec2(0.83205, 0.5547), vec2(0.842271, 0.539054), vec2(0.851658, 0.524097), vec2(0.860292, 0.509802),
    vec2(0.868243, 0.496139), vec2(0.875578, 0.483077), vec2(0.882353, 0.470588), vec2(0.888621, 0.458643),
    vec2(0.282166, 0.959366), vec2(0.33282, 0.94299), vec2(0.38075, 0.924678), vec2(0.425797, 0.904819),
    vec2(0.467888, 0.883788), vec2(0.50702, 0.861934), vec2(0.543251, 0.83957), vec2(0.576683, 0.816968),
    vec2(0.60745, 0.794358), vec2(0.635707, 0.77193), vec2(0.661622, 0.749838), vec2(0.685365, 0.7282),
    vec2(0.707107, 0.707107), vec2(0.727013, 0.686624), vec2(0.745241, 0.666795), vec2(0.761939, 0.647648),
    vec2(0.777245, 0.629198), vec2(0.791285, 0.611448), vec2(0.804176, 0.594391), vec2(0.816024, 0.578017),
    vec2(0.826927, 0.56231), vec2(0.83697, 0.547249), vec2(0.846233, 0.532813), vec2(0.854788, 0.518978),
    vec2(0.862698, 0.505719), vec2(0.870022, 0.493013), vec2(0.876812, 0.480833), vec2(0.316228, 0.948683),
    vec2(0.362446, 0.932005), vec2(0.406138, 0.913812), vec2(0.447214, 0.894427), vec2(0.485643, 0.874157),
    vec2(0.52145, 0.853282), vec2(0.5547, 0.83205), vec2(0.585491, 0.810679), vec2(0.613941, 0.789352),
    vec2(0.640184, 0.768221), vec2(0.664364, 0.747409), vec2(0.686624, 0.727013), vec2(0.707107, 0.707107),
    vec2(0.725953, 0.687745), vec2(0.743294, 0.668965), vec2(0.759257, 0.650791), vec2(0.773957, 0.633238),
    vec2(0.787505, 0.616308), vec2(0.8, 0.6), vec2(0.811534, 0.584305), vec2(0.822192, 0.56921),
    vec2(0.83205, 0.5547), vec2(0.841178, 0.540758), vec2(0.84964, 0.527363), vec2(0.857493, 0.514496),
    vec2(0.864789, 0.502136), vec2(0.345705, 0.938343), vec2(0.388057, 0.921635), vec2(0.428086, 0.903738),
    vec2(0.465746, 0.884918), vec2(0.501036, 0.865426), vec2(0.533993, 0.845489), vec2(0.564684, 0.825307),
    vec2(0.593199, 0.805056), vec2(0.619644, 0.784883), vec2(0.644136, 0.764911), vec2(0.666795, 0.745241),
    vec2(0.687745, 0.725953), vec2(0.707107, 0.707107), vec2(0.724999, 0.688749), vec2(0.741536, 0.670913),
    vec2(0.756823, 0.65362), vec2(0.770962, 0.636881), vec2(0.784046, 0.620703), vec2(0.796162, 0.605083),
    vec2(0.807391, 0.590017), vec2(0.817806, 0.575493), vec2(0.827476, 0.561501), vec2(0.836461, 0.548026),
    vec2(0.844819, 0.535052), vec2(0.852601, 0.522562), vec2(0.33035, 0.943858), vec2(0.371391, 0.928477),
    vec2(0.410365, 0.911922), vec2(0.447214, 0.894427), vec2(0.481919, 0.876216), vec2(0.514496, 0.857493),
    vec2(0.544988, 0.838444), vec2(0.573462, 0.819232), vec2(0.6, 0.8), vec2(0.624695, 0.780869),
    vec2(0.647648, 0.761939), vec2(0.668965, 0.743294), vec2(0.688749, 0.724999), vec2(0.707107, 0.707107),
    vec2(0.724138, 0.689655), vec2(0.73994, 0.672673), vec2(0.754606, 0.656179), vec2(0.768221, 0.640184),
    vec2(0.780869, 0.624695), vec2(0.792624, 0.609711), vec2(0.803557, 0.595228), vec2(0.813733, 0.581238),
    vec2(0.823213, 0.567733), vec2(0.83205, 0.5547), vec2(0.840297, 0.542127), vec2(0.355995, 0.934488),
    vec2(0.393919, 0.919145), vec2(0.429934, 0.902861), vec2(0.464007, 0.885832), vec2(0.496139, 0.868243),
    vec2(0.526355, 0.850265), vec2(0.5547, 0.83205), vec2(0.581238, 0.813733), vec2(0.606043, 0.795432),
    vec2(0.629198, 0.777245), vec2(0.650791, 0.759257), vec2(0.670913, 0.741536), vec2(0.689655, 0.724138),
    vec2(0.707107, 0.707107), vec2(0.723356, 0.690476), vec2(0.738485, 0.674269), vec2(0.752577, 0.658505),
    vec2(0.765705, 0.643192), vec2(0.777941, 0.628337), vec2(0.789352, 0.613941), vec2(0.8, 0.6),
    vec2(0.809942, 0.58651), vec2(0.819232, 0.573462), vec2(0.827919, 0.560848), vec2(0.341743, 0.939793),
    vec2(0.378633, 0.925547), vec2(0.413803, 0.910366), vec2(0.447214, 0.894427), vec2(0.478852, 0.877896),
    vec2(0.508729, 0.860927), vec2(0.536875, 0.843661), vec2(0.563337, 0.826227), vec2(0.588172, 0.808736),
    vec2(0.611448, 0.791285), vec2(0.633238, 0.773957), vec2(0.65362, 0.756823), vec2(0.672673, 0.73994),
    vec2(0.690476, 0.723356), vec2(0.707107, 0.707107), vec2(0.722642, 0.691223), vec2(0.737154, 0.675725),
    vec2(0.750714, 0.660628), vec2(0.763386, 0.645942), vec2(0.775235, 0.631673), vec2(0.786318, 0.617822),
    vec2(0.796691, 0.604386), vec2(0.806405, 0.591364), vec2(0.815507, 0.578747), vec2(0.364399, 0.931243),
    vec2(0.398726, 0.91707), vec2(0.431455, 0.902134), vec2(0.462566, 0.886585), vec2(0.492057, 0.870563),
    vec2(0.519947, 0.854199), vec2(0.546268, 0.837611), vec2(0.571064, 0.820905), vec2(0.594391, 0.804176),
    vec2(0.616308, 0.787505), vec2(0.636881, 0.770962), vec2(0.656179, 0.754606), vec2(0.674269, 0.738485),
    vec2(0.691223, 0.722642), vec2(0.707107, 0.707107), vec2(0.721988, 0.691905), vec2(0.735931, 0.677057),
    vec2(0.748997, 0.662574), vec2(0.761243, 0.648466), vec2(0.772726, 0.634739), vec2(0.783498, 0.621395),
    vec2(0.793606, 0.608432), vec2(0.803098, 0.595847), vec2(0.384615, 0.923077), vec2(0.416655, 0.909065),
    vec2(0.447214, 0.894427), vec2(0.476283, 0.879292), vec2(0.503871, 0.863779), vec2(0.529999, 0.847998),
    vec2(0.5547, 0.83205), vec2(0.578017, 0.816024), vec2(0.6, 0.8), vec2(0.620703, 0.784046),
    vec2(0.640184, 0.768221), vec2(0.658505, 0.752577), vec2(0.675725, 0.737154), vec2(0.691905, 0.721988),
    vec2(0.707107, 0.707107), vec2(0.721387, 0.692532), vec2(0.734803, 0.67828), vec2(0.747409, 0.664364),
    vec2(0.759257, 0.650791), vec2(0.770394, 0.637568), vec2(0.780869, 0.624695), vec2(0.790724, 0.612173),
    vec2(0.402739, 0.915315), vec2(0.432731, 0.901523), vec2(0.461353, 0.887217), vec2(0.488603, 0.872506),
    vec2(0.514496, 0.857493), vec2(0.539054, 0.842271), vec2(0.56231, 0.826927), vec2(0.584305, 0.811534),
    vec2(0.605083, 0.796162), vec2(0.624695, 0.780869), vec2(0.643192, 0.765705), vec2(0.660628, 0.750714),
    vec2(0.677057, 0.735931), vec2(0.692532, 0.721387), vec2(0.707107, 0.707107), vec2(0.720833, 0.693109),
    vec2(0.733761, 0.679408), vec2(0.745938, 0.666016), vec2(0.75741, 0.65294), vec2(0.768221, 0.640184),
    vec2(0.778413, 0.627752), vec2(0.38964, 0.920967), vec2(0.419058, 0.907959), vec2(0.447214, 0.894427),
    vec2(0.4741, 0.880471), vec2(0.499722, 0.866186), vec2(0.524097, 0.851658), vec2(0.547249, 0.83697),
    vec2(0.56921, 0.822192), vec2(0.590017, 0.807391), vec2(0.609711, 0.792624), vec2(0.628337, 0.777941),
    vec2(0.645942, 0.763386), vec2(0.662574, 0.748997), vec2(0.67828, 0.734803), vec2(0.693109, 0.720833),
    vec2(0.707107, 0.707107), vec2(0.72032, 0.693642), vec2(0.732793, 0.680451), vec2(0.744569, 0.667545),
    vec2(0.755689, 0.654931), vec2(0.766192, 0.642612), vec2(0.406138, 0.913812), vec2(0.433816, 0.901002),
    vec2(0.460317, 0.887755), vec2(0.485643, 0.874157), vec2(0.509802, 0.860292), vec2(0.532813, 0.846233),
    vec2(0.5547, 0.83205), vec2(0.575493, 0.817806), vec2(0.595228, 0.803557), vec2(0.613941, 0.789352),
    vec2(0.631673, 0.775235), vec2(0.648466, 0.761243), vec2(0.664364, 0.747409), vec2(0.679408, 0.733761),
    vec2(0.693642, 0.72032), vec2(0.707107, 0.707107), vec2(0.719844, 0.694136), vec2(0.731894, 0.681419),
    vec2(0.743294, 0.668965), vec2(0.754082, 0.656781), vec2(0.421111, 0.907009), vec2(0.447214, 0.894427),
    vec2(0.472221, 0.88148), vec2(0.496139, 0.868243), vec2(0.518978, 0.854788), vec2(0.540758, 0.841178),
    vec2(0.561501, 0.827476), vec2(0.581238, 0.813733), vec2(0.6, 0.8), vec2(0.617822, 0.786318),
    vec2(0.634739, 0.772726), vec2(0.650791, 0.759257), vec2(0.666016, 0.745938), vec2(0.680451, 0.732793),
    vec2(0.694136, 0.719844), vec2(0.707107, 0.707107), vec2(0.719401, 0.694595), vec2(0.731055, 0.682318),
    vec2(0.742103, 0.670286), vec2(0.434749, 0.900552), vec2(0.459423, 0.888218), vec2(0.483077, 0.875578),
    vec2(0.505719, 0.862698), vec2(0.527363, 0.84964), vec2(0.548026, 0.836461), vec2(0.567733, 0.823213),
    vec2(0.58651, 0.809942), vec2(0.604386, 0.796691), vec2(0.621395, 0.783498), vec2(0.637568, 0.770394),
    vec2(0.65294, 0.75741), vec2(0.667545, 0.744569), vec2(0.681419, 0.731894), vec2(0.694595, 0.719401),
    vec2(0.707107, 0.707107), vec2(0.718988, 0.695022), vec2(0.730271, 0.683157), vec2(0.447214, 0.894427),
    vec2(0.470588, 0.882353), vec2(0.493013, 0.870022), vec2(0.514496, 0.857493), vec2(0.535052, 0.844819),
    vec2(0.5547, 0.83205), vec2(0.573462, 0.819232), vec2(0.591364, 0.806405), vec2(0.608432, 0.793606),
    vec2(0.624695, 0.780869), vec2(0.640184, 0.768221), vec2(0.654931, 0.755689), vec2(0.668965, 0.743294),
    vec2(0.682318, 0.731055), vec2(0.695022, 0.718988), vec2(0.707107, 0.707107), vec2(0.718602, 0.695421),
    vec2(0.458643, 0.888621), vec2(0.480833, 0.876812), vec2(0.502136, 0.864789), vec2(0.522562, 0.852601),
    vec2(0.542127, 0.840297), vec2(0.560848, 0.827919), vec2(0.578747, 0.815507), vec2(0.595847, 0.803098),
    vec2(0.612173, 0.790724), vec2(0.627752, 0.778413), vec2(0.642612, 0.766192), vec2(0.656781, 0.754082),
    vec2(0.670286, 0.742103), vec2(0.683157, 0.730271), vec2(0.695421, 0.718602), vec2(0.707107, 0.707107)
);

const float freqOmega[1652] = float[](
    5.907458, 5.946438, 5.98683, 6.028537,
    6.07147, 6.11554, 6.160661, 6.206753,
    6.253737, 6.30154, 6.350091, 6.399323,
    6.449175, 6.499586, 6.550502, 5.796383,
    5.835283, 5.875708, 5.917555, 5.960724,
    6.005117, 6.050641, 6.097208, 6.144732,
    6.193131, 6.242329, 6.292252, 6.342833,
    6.394008, 6.445714, 6.497897, 5.683588,
    5.722343, 5.762752, 5.8047, 5.848079,
    5.892781, 5.938704, 5.985749, 6.033822,
    6.082835, 6.132703, 6.183345, 6.234688,
    6.28666, 6.339195, 6.392233, 6.445714,
    5.569025, 5.607558, 5.647888, 5.689893,
    5.733449, 5.778439, 5.824751, 5.872276,
    5.920909, 5.970553, 6.021115, 6.072506,
    6.124644, 6.177452, 6.230857, 6.284793,
    6.339195, 6.394008, 5.452651, 5.490868,
    5.531046, 5.573048, 5.616741, 5.661994,
    5.708682, 5.756684, 5.805886, 5.856178,
    5.907458, 5.959628, 6.012598, 6.066283,
    6.120603, 6.175483, 6.230857, 6.28666,
    6.342833, 5.33443, 5.372217, 5.412151,
    5.454081, 5.497858, 5.543338, 5.590383,
    5.638857, 5.688633, 5.739591, 5.791615,
    5.844598, 5.898439, 5.953044, 6.008327,
    6.064204, 6.120603, 6.177452, 6.234688,
    6.292252, 5.214336, 5.251555, 5.291132,
    5.332902, 5.376698, 5.422361, 5.469735,
    5.51867, 5.569025, 5.620663, 5.673457,
    5.727287, 5.782042, 5.837616, 5.893914,
    5.950845, 6.008327, 6.066283, 6.124644,
    6.183345, 6.242329, 5.12884, 5.167923,
    5.209422, 5.253155, 5.298942, 5.346609,
    5.395988, 5.44692, 5.499253, 5.552843,
    5.607558, 5.663271, 5.719867, 5.777237,
    5.835283, 5.893914, 5.953044, 6.012598,
    6.072506, 6.132703, 6.193131, 5.004044,
    5.042462, 5.083556, 5.12712, 5.172956,
    5.220866, 5.270663, 5.322167, 5.375206,
    5.429619, 5.485256, 5.541977, 5.59965,
    5.658157, 5.717387, 5.777237, 5.837616,
    5.898439, 5.959628, 6.021115, 6.082835,
    6.144732, 4.877159, 4.914701, 4.955218,
    4.998483, 5.04427, 5.092358, 5.142535,
    5.194597, 5.24835, 5.303612, 5.360212,
    5.417992, 5.476806, 5.536519, 5.597007,
    5.658157, 5.719867, 5.782042, 5.844598,
    5.907458, 5.970553, 6.033822, 6.097208,
    4.748206, 4.78461, 4.824337, 4.867134,
    4.912747, 4.960926, 5.01143, 5.064027,
    5.118496, 5.17463, 5.232236, 5.291132,
    5.351155, 5.412151, 5.473981, 5.536519,
    5.59965, 5.663271, 5.727287, 5.791615,
    5.856178, 5.920909, 5.985749, 6.050641,
    4.652188, 4.690856, 4.73297, 4.778246,
    4.826401, 4.877159, 4.930254, 4.985434,
    5.042462, 5.101116, 5.16119, 5.222495,
    5.28486, 5.348126, 5.412151, 5.476806,
    5.541977, 5.607558, 5.673457, 5.739591,
    5.805886, 5.872276, 5.938704, 6.005117,
    4.517478, 4.554744, 4.595902, 4.64063,
    4.688608, 4.739518, 4.793056, 4.848931,
    4.906869, 4.966614, 5.02793, 5.090601,
    5.15443, 5.219236, 5.28486, 5.351155,
    5.417992, 5.485256, 5.552843, 5.620663,
    5.688633, 5.756684, 5.824751, 5.892781,
    5.960724, 4.416014, 4.455862, 4.499767,
    4.547364, 4.598288, 4.652188, 4.708726,
    4.767583, 4.828462, 4.891091, 4.955218,
    5.020617, 5.087082, 5.15443, 5.222495,
    5.291132, 5.360212, 5.429619, 5.499253,
    5.569025, 5.638857, 5.708682, 5.778439,
    5.848079, 5.917555, 4.274744, 4.312823,
    4.355544, 4.402488, 4.453238, 4.507383,
    4.564528, 4.624302, 4.686356, 4.750371,
    4.816055, 4.883144, 4.951402, 5.020617,
    5.090601, 5.16119, 5.232236, 5.303612,
    5.375206, 5.44692, 5.51867, 5.590383,
    5.661994, 5.733449, 5.8047, 5.875708,
    4.131111, 4.166825, 4.207883, 4.25381,
    4.304125, 4.358347, 4.416014, 4.476684,
    4.539947, 4.605427, 4.672779, 4.741695,
    4.811898, 4.883144, 4.955218, 5.02793,
    5.101116, 5.17463, 5.24835, 5.322167,
    5.395988, 5.469735, 5.543338, 5.616741,
    5.689893, 5.762752, 5.835283, 4.01801,
    4.056768, 4.101185, 4.150706, 4.204767,
    4.26282, 4.32434, 4.388837, 4.455862,
    4.525005, 4.595902, 4.668227, 4.741695,
    4.816055, 4.891091, 4.966614, 5.042462,
    5.118496, 5.194597, 5.270663, 5.346609,
    5.422361, 5.497858, 5.573048, 5.647888,
    5.722343, 5.796383, 3.866684, 3.902289,
    3.944524, 3.99275, 4.046308, 4.104543,
    4.166825, 4.232563, 4.301214, 4.372285,
    4.44534, 4.519991, 4.595902, 4.672779,
    4.750371, 4.828462, 4.906869, 4.985434,
    5.064027, 5.142535, 5.220866, 5.298942,
    5.376698, 5.454081, 5.531046, 5.607558,
    5.683588, 5.759113, 3.744712, 3.783838,
    3.830068, 3.88263, 3.94074, 4.003634,
    4.07059, 4.140943, 4.214094, 4.28951,
    4.366726, 4.44534, 4.525005, 4.605427,
    4.686356, 4.767583, 4.848931, 4.930254,
    5.01143, 5.092358, 5.172956, 5.253155,
    5.332902, 5.412151, 5.490868, 5.569025,
    5.646601, 5.72358, 3.619323, 3.662561,
    3.71341, 3.770931, 3.834188, 3.902289,
    3.974409, 4.049803, 4.127818, 4.207883,
    4.28951, 4.372285, 4.455862, 4.539947,
    4.624302, 4.708726, 4.793056, 4.877159,
    4.960926, 5.04427, 5.12712, 5.209422,
    5.291132, 5.372217, 5.452651, 5.532416,
    5.611499, 5.689893, 3.451495, 3.490314,
    3.538393, 3.594617, 3.657832, 3.726922,
    3.800844, 3.878662, 3.959551, 4.042803,
    4.127818, 4.214094, 4.301214, 4.388837,
    4.476684, 4.564528, 4.652188, 4.739518,
    4.826401, 4.912747, 4.998483, 5.083556,
    5.167923, 5.251555, 5.33443, 5.416534,
    5.497858, 5.578399, 5.658157, 3.313754,
    3.357489, 3.411322, 3.473836, 3.543616,
    3.619323, 3.699749, 3.783838, 3.870689,
    3.959551, 4.049803, 4.140943, 4.232563,
    4.32434, 4.416014, 4.507383, 4.598288,
    4.688608, 4.778246, 4.867134, 4.955218,
    5.042462, 5.12884, 5.214336, 5.298942,
    5.382656, 5.465479, 5.547418, 5.628482,
    3.133955, 3.170962, 3.22069, 3.281421,
    3.351345, 3.428712, 3.511926, 3.599599,
    3.690557, 3.783838, 3.878662, 3.974409,
    4.07059, 4.166825, 4.26282, 4.358347,
    4.453238, 4.547364, 4.64063, 4.73297,
    4.824337, 4.914701, 5.004044, 5.092358,
    5.179644, 5.265906, 5.351155, 5.435404,
    5.51867, 5.600971, 2.979814, 3.0227,
    3.079835, 3.148915, 3.227609, 3.313754,
    3.405465, 3.50117, 3.599599, 3.699749,
    3.800844, 3.902289, 4.003634, 4.104543,
    4.204767, 4.304125, 4.402488, 4.499767,
    4.595902, 4.690856, 4.78461, 4.877159,
    4.968506, 5.058662, 5.147643, 5.23547,
    5.322167, 5.407757, 5.492268, 5.575725,
    2.818134, 2.868568, 2.934992, 3.014269,
    3.103376, 3.199662, 3.300935, 3.405465,
    3.511926, 3.619323, 3.726922, 3.834188,
    3.94074, 4.046308, 4.150706, 4.25381,
    4.355544, 4.455862, 4.554744, 4.652188,
    4.748206, 4.842818, 4.936049, 5.02793,
    5.118496, 5.207781, 5.295822, 5.382656,
    5.468317, 5.552843, 2.647911, 2.708267,
    2.786524, 2.878342, 2.979814, 3.087742,
    3.199662, 3.313754, 3.428712, 3.543616,
    3.657832, 3.770931, 3.88263, 3.99275,
    4.101185, 4.207883, 4.312823, 4.416014,
    4.517478, 4.617251, 4.715375, 4.811898,
    4.906869, 5.000339, 5.092358, 5.182978,
    5.272246, 5.360212, 5.44692, 5.532416,
    2.420387, 2.468024, 2.541778, 2.635332,
    2.742628, 2.858693, 2.979814, 3.103376,
    3.227609, 3.351345, 3.473836, 3.594617,
    3.71341, 3.830068, 3.944524, 4.056768,
    4.166825, 4.274744, 4.380585, 4.484418,
    4.586317, 4.686356, 4.78461, 4.881152,
    4.976051, 5.069375, 5.16119, 5.251555,
    5.34053, 5.42817, 5.514527, 2.216041,
    2.277372, 2.369759, 2.483307, 2.609618,
    2.742628, 2.878342, 3.014269, 3.148915,
    3.281421, 3.411322, 3.538393, 3.662561,
    3.783838, 3.902289, 4.01801, 4.131111,
    4.241708, 4.34992, 4.455862, 4.559644,
    4.661373, 4.76115, 4.859069, 4.955218,
    5.049681, 5.142535, 5.233854, 5.323704,
    5.412151, 5.499253, 1.992722, 2.075353,
    2.194418, 2.334113, 2.483307, 2.635332,
    2.786524, 2.934992, 3.079835, 3.22069,
    3.357489, 3.490314, 3.619323, 3.744712,
    3.866684, 3.985444, 4.101185, 4.214094,
    4.32434, 4.432082, 4.537467, 4.64063,
    4.741695, 4.840775, 4.937976, 5.033395,
    5.12712, 5.219236, 5.309818, 5.398938,
    5.486661, 1.745157, 1.863461, 2.021401,
    2.194418, 2.369759, 2.541778, 2.708267,
    2.868568, 3.0227, 3.170962, 3.313754,
    3.451495, 3.58459, 3.71341, 3.838296,
    3.959551, 4.077449, 4.192234, 4.304125,
    4.413319, 4.519991, 4.624302, 4.726395,
    4.826401, 4.924439, 5.020617, 5.115034,
    5.207781, 5.298942, 5.388593, 5.476806,
    1.467496, 1.650467, 1.863461, 2.075353,
    2.277372, 2.468024, 2.647911, 2.818134,
    2.979814, 3.133955, 3.281421, 3.422945,
    3.559147, 3.690557, 3.817625, 3.94074,
    4.060237, 4.176408, 4.28951, 4.399768,
    4.507383, 4.612532, 4.715375, 4.816055,
    4.914701, 5.01143, 5.106348, 5.199553,
    5.291132, 5.381168, 5.469735, 1.167057,
    1.467496, 1.745157, 1.992722, 2.216041,
    2.420387, 2.609618, 2.786524, 2.953166,
    3.111106, 3.261553, 3.405465, 3.543616,
    3.676639, 3.80506, 3.929323, 4.049803,
    4.166825, 4.280668, 4.391577, 4.499767,
    4.605427, 4.708726, 4.809815, 4.90883,
    5.005894, 5.101116, 5.194597, 5.28643,
    5.376698, 5.465479, 0.981374, 1.387872,
    1.699789, 1.962748, 2.194418, 2.403865,
    2.596471, 2.775744, 2.944121, 3.103376,
    3.254849, 3.399578, 3.538393, 3.671964,
    3.800844, 3.925495, 4.046308, 4.163616,
    4.277709, 4.388837, 4.49722, 4.603051,
    4.706503, 4.80773, 4.906869, 5.004044,
    5.099368, 5.192942, 5.28486, 5.375206,
    5.464058, 1.167057, 1.467496, 1.745157,
    1.992722, 2.216041, 2.420387, 2.609618,
    2.786524, 2.953166, 3.111106, 3.261553,
    3.405465, 3.543616, 3.676639, 3.80506,
    3.929323, 4.049803, 4.166825, 4.280668,
    4.391577, 4.499767, 4.605427, 4.708726,
    4.809815, 4.90883, 5.005894, 5.101116,
    5.194597, 5.28643, 5.376698, 5.465479,
    1.467496, 1.650467, 1.863461, 2.075353,
    2.277372, 2.468024, 2.647911, 2.818134,
    2.979814, 3.133955, 3.281421, 3.422945,
    3.559147, 3.690557, 3.817625, 3.94074,
    4.060237, 4.176408, 4.28951, 4.399768,
    4.507383, 4.612532, 4.715375, 4.816055,
    4.914701, 5.01143, 5.106348, 5.199553,
    5.291132, 5.381168, 5.469735, 1.745157,
    1.863461, 2.021401, 2.194418, 2.369759,
    2.541778, 2.708267, 2.868568, 3.0227,
    3.170962, 3.313754, 3.451495, 3.58459,
    3.71341, 3.838296, 3.959551, 4.077449,
    4.192234, 4.304125, 4.413319, 4.519991,
    4.624302, 4.726395, 4.826401, 4.924439,
    5.020617, 5.115034, 5.207781, 5.298942,
    5.388593, 5.476806, 1.992722, 2.075353,
    2.194418, 2.334113, 2.483307, 2.635332,
    2.786524, 2.934992, 3.079835, 3.22069,
    3.357489, 3.490314, 3.619323, 3.744712,
    3.866684, 3.985444, 4.101185, 4.214094,
    4.32434, 4.432082, 4.537467, 4.64063,
    4.741695, 4.840775, 4.937976, 5.033395,
    5.12712, 5.219236, 5.309818, 5.398938,
    5.486661, 2.216041, 2.277372, 2.369759,
    2.483307, 2.609618, 2.742628, 2.878342,
    3.014269, 3.148915, 3.281421, 3.411322,
    3.538393, 3.662561, 3.783838, 3.902289,
    4.01801, 4.131111, 4.241708, 4.34992,
    4.455862, 4.559644, 4.661373, 4.76115,
    4.859069, 4.955218, 5.049681, 5.142535,
    5.233854, 5.323704, 5.412151, 5.499253,
    2.420387, 2.468024, 2.541778, 2.635332,
    2.742628, 2.858693, 2.979814, 3.103376,
    3.227609, 3.351345, 3.473836, 3.594617,
    3.71341, 3.830068, 3.944524, 4.056768,
    4.166825, 4.274744, 4.380585, 4.484418,
    4.586317, 4.686356, 4.78461, 4.881152,
    4.976051, 5.069375, 5.16119, 5.251555,
    5.34053, 5.42817, 5.514527, 2.647911,
    2.708267, 2.786524, 2.878342, 2.979814,
    3.087742, 3.199662, 3.313754, 3.428712,
    3.543616, 3.657832, 3.770931, 3.88263,
    3.99275, 4.101185, 4.207883, 4.312823,
    4.416014, 4.517478, 4.617251, 4.715375,
    4.811898, 4.906869, 5.000339, 5.092358,
    5.182978, 5.272246, 5.360212, 5.44692,
    5.532416, 2.818134, 2.868568, 2.934992,
    3.014269, 3.103376, 3.199662, 3.300935,
    3.405465, 3.511926, 3.619323, 3.726922,
    3.834188, 3.94074, 4.046308, 4.150706,
    4.25381, 4.355544, 4.455862, 4.554744,
    4.652188, 4.748206, 4.842818, 4.936049,
    5.02793, 5.118496, 5.207781, 5.295822,
    5.382656, 5.468317, 5.552843, 2.979814,
    3.0227, 3.079835, 3.148915, 3.227609,
    3.313754, 3.405465, 3.50117, 3.599599,
    3.699749, 3.800844, 3.902289, 4.003634,
    4.104543, 4.204767, 4.304125, 4.402488,
    4.499767, 4.595902, 4.690856, 4.78461,
    4.877159, 4.968506, 5.058662, 5.147643,
    5.23547, 5.322167, 5.407757, 5.492268,
    5.575725, 3.133955, 3.170962, 3.22069,
    3.281421, 3.351345, 3.428712, 3.511926,
    3.599599, 3.690557, 3.783838, 3.878662,
    3.974409, 4.07059, 4.166825, 4.26282,
    4.358347, 4.453238, 4.547364, 4.64063,
    4.73297, 4.824337, 4.914701, 5.004044,
    5.092358, 5.179644, 5.265906, 5.351155,
    5.435404, 5.51867, 5.600971, 3.313754,
    3.357489, 3.411322, 3.473836, 3.543616,
    3.619323, 3.699749, 3.783838, 3.870689,
    3.959551, 4.049803, 4.140943, 4.232563,
    4.32434, 4.416014, 4.507383, 4.598288,
    4.688608, 4.778246, 4.867134, 4.955218,
    5.042462, 5.12884, 5.214336, 5.298942,
    5.382656, 5.465479, 5.547418, 5.628482,
    3.451495, 3.490314, 3.538393, 3.594617,
    3.657832, 3.726922, 3.800844, 3.878662,
    3.959551, 4.042803, 4.127818, 4.214094,
    4.301214, 4.388837, 4.476684, 4.564528,
    4.652188, 4.739518, 4.826401, 4.912747,
    4.998483, 5.083556, 5.167923, 5.251555,
    5.33443, 5.416534, 5.497858, 5.578399,
    5.658157, 3.619323, 3.662561, 3.71341,
    3.770931, 3.834188, 3.902289, 3.974409,
    4.049803, 4.127818, 4.207883, 4.28951,
    4.372285, 4.455862, 4.539947, 4.624302,
    4.708726, 4.793056, 4.877159, 4.960926,
    5.04427, 5.12712, 5.209422, 5.291132,
    5.372217, 5.452651, 5.532416, 5.611499,
    5.689893, 3.744712, 3.783838, 3.830068,
    3.88263, 3.94074, 4.003634, 4.07059,
    4.140943, 4.214094, 4.28951, 4.366726,
    4.44534, 4.525005, 4.605427, 4.686356,
    4.767583, 4.848931, 4.930254, 5.01143,
    5.092358, 5.172956, 5.253155, 5.332902,
    5.412151, 5.490868, 5.569025, 5.646601,
    5.72358, 3.866684, 3.902289, 3.944524,
    3.99275, 4.046308, 4.104543, 4.166825,
    4.232563, 4.301214, 4.372285, 4.44534,
    4.519991, 4.595902, 4.672779, 4.750371,
    4.828462, 4.906869, 4.985434, 5.064027,
    5.142535, 5.220866, 5.298942, 5.376698,
    5.454081, 5.531046, 5.607558, 5.683588,
    5.759113, 4.01801, 4.056768, 4.101185,
    4.150706, 4.204767, 4.26282, 4.32434,
    4.388837, 4.455862, 4.525005, 4.595902,
    4.668227, 4.741695, 4.816055, 4.891091,
    4.966614, 5.042462, 5.118496, 5.194597,
    5.270663, 5.346609, 5.422361, 5.497858,
    5.573048, 5.647888, 5.722343, 5.796383,
    4.131111, 4.166825, 4.207883, 4.25381,
    4.304125, 4.358347, 4.416014, 4.476684,
    4.539947, 4.605427, 4.672779, 4.741695,
    4.811898, 4.883144, 4.955218, 5.02793,
    5.101116, 5.17463, 5.24835, 5.322167,
    5.395988, 5.469735, 5.543338, 5.616741,
    5.689893, 5.762752, 5.835283, 4.274744,
    4.312823, 4.355544, 4.402488, 4.453238,
    4.507383, 4.564528, 4.624302, 4.686356,
    4.750371, 4.816055, 4.883144, 4.951402,
    5.020617, 5.090601, 5.16119, 5.232236,
    5.303612, 5.375206, 5.44692, 5.51867,
    5.590383, 5.661994, 5.733449, 5.8047,
    5.875708, 4.416014, 4.455862, 4.499767,
    4.547364, 4.598288, 4.652188, 4.708726,
    4.767583, 4.828462, 4.891091, 4.955218,
    5.020617, 5.087082, 5.15443, 5.222495,
    5.291132, 5.360212, 5.429619, 5.499253,
    5.569025, 5.638857, 5.708682, 5.778439,
    5.848079, 5.917555, 4.517478, 4.554744,
    4.595902, 4.64063, 4.688608, 4.739518,
    4.793056, 4.848931, 4.906869, 4.966614,
    5.02793, 5.090601, 5.15443, 5.219236,
    5.28486, 5.351155, 5.417992, 5.485256,
    5.552843, 5.620663, 5.688633, 5.756684,
    5.824751, 5.892781, 5.960724, 4.652188,
    4.690856, 4.73297, 4.778246, 4.826401,
    4.877159, 4.930254, 4.985434, 5.042462,
    5.101116, 5.16119, 5.222495, 5.28486,
    5.348126, 5.412151, 5.476806, 5.541977,
    5.607558, 5.673457, 5.739591, 5.805886,
    5.872276, 5.938704, 6.005117, 4.748206,
    4.78461, 4.824337, 4.867134, 4.912747,
    4.960926, 5.01143, 5.064027, 5.118496,
    5.17463, 5.232236, 5.291132, 5.351155,
    5.412151, 5.473981, 5.536519, 5.59965,
    5.663271, 5.727287, 5.791615, 5.856178,
    5.920909, 5.985749, 6.050641, 4.877159,
    4.914701, 4.955218, 4.998483, 5.04427,
    5.092358, 5.142535, 5.194597, 5.24835,
    5.303612, 5.360212, 5.417992, 5.476806,
    5.536519, 5.597007, 5.658157, 5.719867,
    5.782042, 5.844598, 5.907458, 5.970553,
    6.033822, 6.097208, 5.004044, 5.042462,
    5.083556, 5.12712, 5.172956, 5.220866,
    5.270663, 5.322167, 5.375206, 5.429619,
    5.485256, 5.541977, 5.59965, 5.658157,
    5.717387, 5.777237, 5.837616, 5.898439,
    5.959628, 6.021115, 6.082835, 6.144732,
    5.12884, 5.167923, 5.209422, 5.253155,
    5.298942, 5.346609, 5.395988, 5.44692,
    5.499253, 5.552843, 5.607558, 5.663271,
    5.719867, 5.777237, 5.835283, 5.893914,
    5.953044, 6.012598, 6.072506, 6.132703,
    6.193131, 5.214336, 5.251555, 5.291132,
    5.332902, 5.376698, 5.422361, 5.469735,
    5.51867, 5.569025, 5.620663, 5.673457,
    5.727287, 5.782042, 5.837616, 5.893914,
    5.950845, 6.008327, 6.066283, 6.124644,
    6.183345, 6.242329, 5.33443, 5.372217,
    5.412151, 5.454081, 5.497858, 5.543338,
    5.590383, 5.638857, 5.688633, 5.739591,
    5.791615, 5.844598, 5.898439, 5.953044,
    6.008327, 6.064204, 6.120603, 6.177452,
    6.234688, 6.292252, 5.452651, 5.490868,
    5.531046, 5.573048, 5.616741, 5.661994,
    5.708682, 5.756684, 5.805886, 5.856178,
    5.907458, 5.959628, 6.012598, 6.066283,
    6.120603, 6.175483, 6.230857, 6.28666,
    6.342833, 5.569025, 5.607558, 5.647888,
    5.689893, 5.733449, 5.778439, 5.824751,
    5.872276, 5.920909, 5.970553, 6.021115,
    6.072506, 6.124644, 6.177452, 6.230857,
    6.284793, 6.339195, 6.394008, 5.683588,
    5.722343, 5.762752, 5.8047, 5.848079,
    5.892781, 5.938704, 5.985749, 6.033822,
    6.082835, 6.132703, 6.183345, 6.234688,
    6.28666, 6.339195, 6.392233, 6.445714,
    5.796383, 5.835283, 5.875708, 5.917555,
    5.960724, 6.005117, 6.050641, 6.097208,
    6.144732, 6.193131, 6.242329, 6.292252,
    6.342833, 6.394008, 6.445714, 6.497897
);

const float freqAmp[1652] = float[](
    0.000108, 0.000119, 0.000131, 0.000142,
    0.000153, 0.000163, 0.000173, 0.000182,
    0.00019, 0.000198, 0.000205, 0.000211,
    0.000216, 0.000221, 0.000224, 0.000109,
    0.000122, 0.000135, 0.000148, 0.00016,
    0.000172, 0.000182, 0.000193, 0.000202,
    0.000211, 0.000218, 0.000225, 0.000231,
    0.000236, 0.00024, 0.000244, 0.00011,
    0.000124, 0.000139, 0.000153, 0.000167,
    0.00018, 0.000192, 0.000204, 0.000215,
    0.000224, 0.000233, 0.000241, 0.000248,
    0.000253, 0.000258, 0.000262, 0.000265,
    0.00011, 0.000126, 0.000142, 0.000158,
    0.000174, 0.000189, 0.000203, 0.000216,
    0.000228, 0.000239, 0.000249, 0.000258,
    0.000266, 0.000272, 0.000278, 0.000282,
    0.000286, 0.000288, 0.000109, 0.000127,
    0.000145, 0.000163, 0.000181, 0.000198,
    0.000214, 0.000229, 0.000243, 0.000255,
    0.000267, 0.000277, 0.000286, 0.000293,
    0.0003, 0.000305, 0.000309, 0.000312,
    0.000314, 0.000108, 0.000127, 0.000147,
    0.000168, 0.000187, 0.000207, 0.000225,
    0.000242, 0.000258, 0.000273, 0.000286,
    0.000298, 0.000308, 0.000317, 0.000324,
    0.00033, 0.000334, 0.000337, 0.00034,
    0.000341, 0.000104, 0.000126, 0.000149,
    0.000171, 0.000194, 0.000216, 0.000237,
    0.000257, 0.000275, 0.000292, 0.000307,
    0.000321, 0.000332, 0.000342, 0.000351,
    0.000357, 0.000363, 0.000366, 0.000369,
    0.00037, 0.00037, 0.000124, 0.000148,
    0.000174, 0.0002, 0.000225, 0.000249,
    0.000272, 0.000293, 0.000313, 0.000331,
    0.000346, 0.00036, 0.000371, 0.000381,
    0.000389, 0.000395, 0.000399, 0.000401,
    0.000403, 0.000403, 0.000401, 0.000119,
    0.000147, 0.000176, 0.000205, 0.000233,
    0.000261, 0.000288, 0.000313, 0.000336,
    0.000356, 0.000375, 0.000391, 0.000404,
    0.000415, 0.000424, 0.000431, 0.000435,
    0.000438, 0.00044, 0.00044, 0.000438,
    0.000435, 0.000113, 0.000143, 0.000175,
    0.000208, 0.000241, 0.000274, 0.000305,
    0.000334, 0.000361, 0.000385, 0.000406,
    0.000425, 0.000441, 0.000454, 0.000464,
    0.000472, 0.000477, 0.00048, 0.000482,
    0.000481, 0.000479, 0.000476, 0.000472,
    0.000104, 0.000137, 0.000173, 0.00021,
    0.000248, 0.000286, 0.000322, 0.000356,
    0.000388, 0.000417, 0.000442, 0.000464,
    0.000482, 0.000497, 0.000509, 0.000518,
    0.000524, 0.000528, 0.000529, 0.000529,
    0.000526, 0.000522, 0.000517, 0.00051,
    0.000128, 0.000167, 0.000209, 0.000253,
    0.000297, 0.00034, 0.00038, 0.000418,
    0.000452, 0.000482, 0.000508, 0.00053,
    0.000548, 0.000562, 0.000572, 0.000579,
    0.000583, 0.000584, 0.000583, 0.00058,
    0.000575, 0.000569, 0.000561, 0.000552,
    0.000115, 0.000158, 0.000206, 0.000256,
    0.000307, 0.000357, 0.000405, 0.00045,
    0.000491, 0.000527, 0.000558, 0.000584,
    0.000605, 0.000622, 0.000634, 0.000642,
    0.000646, 0.000648, 0.000646, 0.000642,
    0.000636, 0.000627, 0.000618, 0.000607,
    0.000596, 0.000145, 0.000197, 0.000254,
    0.000314, 0.000373, 0.000431, 0.000485,
    0.000534, 0.000578, 0.000615, 0.000647,
    0.000672, 0.000692, 0.000706, 0.000715,
    0.00072, 0.000721, 0.000719, 0.000713,
    0.000705, 0.000695, 0.000684, 0.000671,
    0.000657, 0.000642, 0.000126, 0.000184,
    0.000248, 0.000317, 0.000388, 0.000457,
    0.000522, 0.000582, 0.000635, 0.000681,
    0.00072, 0.00075, 0.000774, 0.000791,
    0.000801, 0.000806, 0.000807, 0.000803,
    0.000796, 0.000786, 0.000774, 0.000759,
    0.000744, 0.000727, 0.000709, 0.00069,
    0.000103, 0.000164, 0.000235, 0.000315,
    0.000398, 0.000482, 0.000562, 0.000635,
    0.000701, 0.000758, 0.000805, 0.000842,
    0.000871, 0.000891, 0.000903, 0.000909,
    0.000908, 0.000903, 0.000894, 0.000881,
    0.000865, 0.000847, 0.000828, 0.000807,
    0.000786, 0.000763, 0.000741, 0.000137,
    0.000214, 0.000305, 0.000403, 0.000504,
    0.000602, 0.000694, 0.000776, 0.000847,
    0.000905, 0.000952, 0.000986, 0.00101,
    0.001025, 0.00103, 0.001029, 0.001021,
    0.001009, 0.000992, 0.000972, 0.00095,
    0.000926, 0.000901, 0.000874, 0.000848,
    0.000821, 0.000794, 0.000103, 0.000183,
    0.000284, 0.000399, 0.000521, 0.000643,
    0.000758, 0.000861, 0.000951, 0.001025,
    0.001083, 0.001126, 0.001155, 0.001171,
    0.001177, 0.001174, 0.001163, 0.001146,
    0.001125, 0.001099, 0.001071, 0.001041,
    0.001009, 0.000977, 0.000945, 0.000912,
    0.00088, 0.000848, 0.000142, 0.00025,
    0.000382, 0.000529, 0.00068, 0.000826,
    0.000958, 0.001074, 0.001168, 0.001242,
    0.001296, 0.001332, 0.001351, 0.001357,
    0.00135, 0.001335, 0.001312, 0.001283,
    0.00125, 0.001214, 0.001176, 0.001137,
    0.001097, 0.001057, 0.001018, 0.000979,
    0.00094, 0.000903, 0.0002, 0.000346,
    0.000521, 0.000709, 0.000896, 0.001068,
    0.001219, 0.001343, 0.001439, 0.001508,
    0.001552, 0.001574, 0.001578, 0.001568,
    0.001545, 0.001514, 0.001475, 0.001432,
    0.001385, 0.001337, 0.001288, 0.001238,
    0.001189, 0.00114, 0.001093, 0.001047,
    0.001002, 0.00096, 0.000136, 0.000288,
    0.00049, 0.000722, 0.000963, 0.001191,
    0.001392, 0.001558, 0.001685, 0.001774,
    0.00183, 0.001855, 0.001857, 0.001839,
    0.001806, 0.001762, 0.00171, 0.001653,
    0.001592, 0.00153, 0.001467, 0.001404,
    0.001343, 0.001283, 0.001225, 0.001169,
    0.001116, 0.001065, 0.001016, 0.000204,
    0.000424, 0.000707, 0.001018, 0.001324,
    0.001598, 0.001825, 0.001997, 0.002117,
    0.002187, 0.002217, 0.002213, 0.002184,
    0.002135, 0.002073, 0.002001, 0.001924,
    0.001843, 0.001762, 0.001681, 0.001602,
    0.001525, 0.00145, 0.001379, 0.001311,
    0.001247, 0.001185, 0.001127, 0.001072,
    0.000106, 0.000318, 0.000644, 0.001043,
    0.001459, 0.001843, 0.002162, 0.002404,
    0.002567, 0.002659, 0.002692, 0.002678,
    0.00263, 0.002557, 0.002467, 0.002367,
    0.002261, 0.002153, 0.002045, 0.00194,
    0.001838, 0.001741, 0.001648, 0.001559,
    0.001476, 0.001397, 0.001323, 0.001254,
    0.001189, 0.001127, 0.000175, 0.000513,
    0.001008, 0.001577, 0.002127, 0.002594,
    0.002945, 0.003175, 0.003297, 0.003332,
    0.0033, 0.003219, 0.003107, 0.002975,
    0.002832, 0.002685, 0.002538, 0.002394,
    0.002256, 0.002124, 0.001999, 0.001881,
    0.001771, 0.001668, 0.001572, 0.001482,
    0.001399, 0.001321, 0.001248, 0.001181,
    0.000307, 0.000867, 0.001634, 0.002443,
    0.003153, 0.003686, 0.004026, 0.004193,
    0.004223, 0.004155, 0.004019, 0.003843,
    0.003644, 0.003435, 0.003226, 0.003023,
    0.002827, 0.002643, 0.00247, 0.002309,
    0.002159, 0.002021, 0.001893, 0.001774,
    0.001665, 0.001564, 0.001471, 0.001385,
    0.001305, 0.001231, 0.000572, 0.001542,
    0.002747, 0.003878, 0.004737, 0.005266,
    0.005502, 0.005513, 0.005372, 0.005137,
    0.00485, 0.004542, 0.00423, 0.003928,
    0.003641, 0.003372, 0.003123, 0.002894,
    0.002684, 0.002492, 0.002316, 0.002156,
    0.00201, 0.001876, 0.001754, 0.001642,
    0.001539, 0.001445, 0.001359, 0.001279,
    0.000176, 0.001157, 0.002909, 0.004802,
    0.00629, 0.007177, 0.007521, 0.007473,
    0.007179, 0.006754, 0.006271, 0.005778,
    0.0053, 0.004852, 0.004438, 0.004062,
    0.003722, 0.003415, 0.003139, 0.00289,
    0.002667, 0.002466, 0.002284, 0.00212,
    0.001971, 0.001837, 0.001714, 0.001602,
    0.0015, 0.001407, 0.001322, 0.000425,
    0.002587, 0.005866, 0.008705, 0.010347,
    0.01087, 0.010642, 0.010006, 0.009195,
    0.008344, 0.007524, 0.006768, 0.006087,
    0.005481, 0.004946, 0.004474, 0.004059,
    0.003692, 0.003369, 0.003083, 0.002829,
    0.002602, 0.0024, 0.002219, 0.002057,
    0.001911, 0.001778, 0.001658, 0.001549,
    0.00145, 0.00136, 0.00123, 0.006553,
    0.012658, 0.016182, 0.017001, 0.016208,
    0.014724, 0.013068, 0.011484, 0.010063,
    0.008826, 0.007764, 0.006858, 0.006084,
    0.005423, 0.004856, 0.004367, 0.003943,
    0.003575, 0.003254, 0.002971, 0.002722,
    0.002502, 0.002306, 0.002131, 0.001974,
    0.001833, 0.001706, 0.001591, 0.001487,
    0.001392, 0.004635, 0.019244, 0.028785,
    0.030005, 0.027158, 0.023274, 0.019583,
    0.016436, 0.013854, 0.011761, 0.010066,
    0.008686, 0.007555, 0.00662, 0.00584,
    0.005185, 0.004629, 0.004155, 0.003748,
    0.003396, 0.003089, 0.002821, 0.002585,
    0.002376, 0.002191, 0.002026, 0.001878,
    0.001745, 0.001625, 0.001516, 0.001418,
    0.026216, 0.06478, 0.064948, 0.052428,
    0.040429, 0.03125, 0.02454, 0.019631,
    0.015986, 0.013229, 0.011106, 0.009441,
    0.008115, 0.007043, 0.006166, 0.005439,
    0.004831, 0.004317, 0.003879, 0.003503,
    0.003178, 0.002895, 0.002647, 0.002429,
    0.002235, 0.002064, 0.00191, 0.001773,
    0.001649, 0.001538, 0.001436, 0.258738,
    0.209726, 0.125154, 0.078716, 0.053128,
    0.037981, 0.028392, 0.021978, 0.017491,
    0.014236, 0.011803, 0.009938, 0.008479,
    0.007315, 0.006373, 0.0056, 0.004957,
    0.004418, 0.00396, 0.003569, 0.003232,
    0.00294, 0.002685, 0.002461, 0.002263,
    0.002087, 0.00193, 0.00179, 0.001664,
    0.001551, 0.001448, 1.460241, 0.366309,
    0.162869, 0.091601, 0.058603, 0.040676,
    0.029865, 0.022848, 0.018037, 0.014595,
    0.012049, 0.010112, 0.008605, 0.007409,
    0.006445, 0.005655, 0.005001, 0.004452,
    0.003988, 0.003592, 0.003251, 0.002955,
    0.002698, 0.002471, 0.002272, 0.002095,
    0.001937, 0.001796, 0.001669, 0.001555,
    0.001452, 0.258738, 0.209726, 0.125154,
    0.078716, 0.053128, 0.037981, 0.028392,
    0.021978, 0.017491, 0.014236, 0.011803,
    0.009938, 0.008479, 0.007315, 0.006373,
    0.0056, 0.004957, 0.004418, 0.00396,
    0.003569, 0.003232, 0.00294, 0.002685,
    0.002461, 0.002263, 0.002087, 0.00193,
    0.00179, 0.001664, 0.001551, 0.001448,
    0.026216, 0.06478, 0.064948, 0.052428,
    0.040429, 0.03125, 0.02454, 0.019631,
    0.015986, 0.013229, 0.011106, 0.009441,
    0.008115, 0.007043, 0.006166, 0.005439,
    0.004831, 0.004317, 0.003879, 0.003503,
    0.003178, 0.002895, 0.002647, 0.002429,
    0.002235, 0.002064, 0.00191, 0.001773,
    0.001649, 0.001538, 0.001436, 0.004635,
    0.019244, 0.028785, 0.030005, 0.027158,
    0.023274, 0.019583, 0.016436, 0.013854,
    0.011761, 0.010066, 0.008686, 0.007555,
    0.00662, 0.00584, 0.005185, 0.004629,
    0.004155, 0.003748, 0.003396, 0.003089,
    0.002821, 0.002585, 0.002376, 0.002191,
    0.002026, 0.001878, 0.001745, 0.001625,
    0.001516, 0.001418, 0.00123, 0.006553,
    0.012658, 0.016182, 0.017001, 0.016208,
    0.014724, 0.013068, 0.011484, 0.010063,
    0.008826, 0.007764, 0.006858, 0.006084,
    0.005423, 0.004856, 0.004367, 0.003943,
    0.003575, 0.003254, 0.002971, 0.002722,
    0.002502, 0.002306, 0.002131, 0.001974,
    0.001833, 0.001706, 0.001591, 0.001487,
    0.001392, 0.000425, 0.002587, 0.005866,
    0.008705, 0.010347, 0.01087, 0.010642,
    0.010006, 0.009195, 0.008344, 0.007524,
    0.006768, 0.006087, 0.005481, 0.004946,
    0.004474, 0.004059, 0.003692, 0.003369,
    0.003083, 0.002829, 0.002602, 0.0024,
    0.002219, 0.002057, 0.001911, 0.001778,
    0.001658, 0.001549, 0.00145, 0.00136,
    0.000176, 0.001157, 0.002909, 0.004802,
    0.00629, 0.007177, 0.007521, 0.007473,
    0.007179, 0.006754, 0.006271, 0.005778,
    0.0053, 0.004852, 0.004438, 0.004062,
    0.003722, 0.003415, 0.003139, 0.00289,
    0.002667, 0.002466, 0.002284, 0.00212,
    0.001971, 0.001837, 0.001714, 0.001602,
    0.0015, 0.001407, 0.001322, 0.000572,
    0.001542, 0.002747, 0.003878, 0.004737,
    0.005266, 0.005502, 0.005513, 0.005372,
    0.005137, 0.00485, 0.004542, 0.00423,
    0.003928, 0.003641, 0.003372, 0.003123,
    0.002894, 0.002684, 0.002492, 0.002316,
    0.002156, 0.00201, 0.001876, 0.001754,
    0.001642, 0.001539, 0.001445, 0.001359,
    0.001279, 0.000307, 0.000867, 0.001634,
    0.002443, 0.003153, 0.003686, 0.004026,
    0.004193, 0.004223, 0.004155, 0.004019,
    0.003843, 0.003644, 0.003435, 0.003226,
    0.003023, 0.002827, 0.002643, 0.00247,
    0.002309, 0.002159, 0.002021, 0.001893,
    0.001774, 0.001665, 0.001564, 0.001471,
    0.001385, 0.001305, 0.001231, 0.000175,
    0.000513, 0.001008, 0.001577, 0.002127,
    0.002594, 0.002945, 0.003175, 0.003297,
    0.003332, 0.0033, 0.003219, 0.003107,
    0.002975, 0.002832, 0.002685, 0.002538,
    0.002394, 0.002256, 0.002124, 0.001999,
    0.001881, 0.001771, 0.001668, 0.001572,
    0.001482, 0.001399, 0.001321, 0.001248,
    0.001181, 0.000106, 0.000318, 0.000644,
    0.001043, 0.001459, 0.001843, 0.002162,
    0.002404, 0.002567, 0.002659, 0.002692,
    0.002678, 0.00263, 0.002557, 0.002467,
    0.002367, 0.002261, 0.002153, 0.002045,
    0.00194, 0.001838, 0.001741, 0.001648,
    0.001559, 0.001476, 0.001397, 0.001323,
    0.001254, 0.001189, 0.001127, 0.000204,
    0.000424, 0.000707, 0.001018, 0.001324,
    0.001598, 0.001825, 0.001997, 0.002117,
    0.002187, 0.002217, 0.002213, 0.002184,
    0.002135, 0.002073, 0.002001, 0.001924,
    0.001843, 0.001762, 0.001681, 0.001602,
    0.001525, 0.00145, 0.001379, 0.001311,
    0.001247, 0.001185, 0.001127, 0.001072,
    0.000136, 0.000288, 0.00049, 0.000722,
    0.000963, 0.001191, 0.001392, 0.001558,
    0.001685, 0.001774, 0.00183, 0.001855,
    0.001857, 0.001839, 0.001806, 0.001762,
    0.00171, 0.001653, 0.001592, 0.00153,
    0.001467, 0.001404, 0.001343, 0.001283,
    0.001225, 0.001169, 0.001116, 0.001065,
    0.001016, 0.0002, 0.000346, 0.000521,
    0.000709, 0.000896, 0.001068, 0.001219,
    0.001343, 0.001439, 0.001508, 0.001552,
    0.001574, 0.001578, 0.001568, 0.001545,
    0.001514, 0.001475, 0.001432, 0.001385,
    0.001337, 0.001288, 0.001238, 0.001189,
    0.00114, 0.001093, 0.001047, 0.001002,
    0.00096, 0.000142, 0.00025, 0.000382,
    0.000529, 0.00068, 0.000826, 0.000958,
    0.001074, 0.001168, 0.001242, 0.001296,
    0.001332, 0.001351, 0.001357, 0.00135,
    0.001335, 0.001312, 0.001283, 0.00125,
    0.001214, 0.001176, 0.001137, 0.001097,
    0.001057, 0.001018, 0.000979, 0.00094,
    0.000903, 0.000103, 0.000183, 0.000284,
    0.000399, 0.000521, 0.000643, 0.000758,
    0.000861, 0.000951, 0.001025, 0.001083,
    0.001126, 0.001155, 0.001171, 0.001177,
    0.001174, 0.001163, 0.001146, 0.001125,
    0.001099, 0.001071, 0.001041, 0.001009,
    0.000977, 0.000945, 0.000912, 0.00088,
    0.000848, 0.000137, 0.000214, 0.000305,
    0.000403, 0.000504, 0.000602, 0.000694,
    0.000776, 0.000847, 0.000905, 0.000952,
    0.000986, 0.00101, 0.001025, 0.00103,
    0.001029, 0.001021, 0.001009, 0.000992,
    0.000972, 0.00095, 0.000926, 0.000901,
    0.000874, 0.000848, 0.000821, 0.000794,
    0.000103, 0.000164, 0.000235, 0.000315,
    0.000398, 0.000482, 0.000562, 0.000635,
    0.000701, 0.000758, 0.000805, 0.000842,
    0.000871, 0.000891, 0.000903, 0.000909,
    0.000908, 0.000903, 0.000894, 0.000881,
    0.000865, 0.000847, 0.000828, 0.000807,
    0.000786, 0.000763, 0.000741, 0.000126,
    0.000184, 0.000248, 0.000317, 0.000388,
    0.000457, 0.000522, 0.000582, 0.000635,
    0.000681, 0.00072, 0.00075, 0.000774,
    0.000791, 0.000801, 0.000806, 0.000807,
    0.000803, 0.000796, 0.000786, 0.000774,
    0.000759, 0.000744, 0.000727, 0.000709,
    0.00069, 0.000145, 0.000197, 0.000254,
    0.000314, 0.000373, 0.000431, 0.000485,
    0.000534, 0.000578, 0.000615, 0.000647,
    0.000672, 0.000692, 0.000706, 0.000715,
    0.00072, 0.000721, 0.000719, 0.000713,
    0.000705, 0.000695, 0.000684, 0.000671,
    0.000657, 0.000642, 0.000115, 0.000158,
    0.000206, 0.000256, 0.000307, 0.000357,
    0.000405, 0.00045, 0.000491, 0.000527,
    0.000558, 0.000584, 0.000605, 0.000622,
    0.000634, 0.000642, 0.000646, 0.000648,
    0.000646, 0.000642, 0.000636, 0.000627,
    0.000618, 0.000607, 0.000596, 0.000128,
    0.000167, 0.000209, 0.000253, 0.000297,
    0.00034, 0.00038, 0.000418, 0.000452,
    0.000482, 0.000508, 0.00053, 0.000548,
    0.000562, 0.000572, 0.000579, 0.000583,
    0.000584, 0.000583, 0.00058, 0.000575,
    0.000569, 0.000561, 0.000552, 0.000104,
    0.000137, 0.000173, 0.00021, 0.000248,
    0.000286, 0.000322, 0.000356, 0.000388,
    0.000417, 0.000442, 0.000464, 0.000482,
    0.000497, 0.000509, 0.000518, 0.000524,
    0.000528, 0.000529, 0.000529, 0.000526,
    0.000522, 0.000517, 0.00051, 0.000113,
    0.000143, 0.000175, 0.000208, 0.000241,
    0.000274, 0.000305, 0.000334, 0.000361,
    0.000385, 0.000406, 0.000425, 0.000441,
    0.000454, 0.000464, 0.000472, 0.000477,
    0.00048, 0.000482, 0.000481, 0.000479,
    0.000476, 0.000472, 0.000119, 0.000147,
    0.000176, 0.000205, 0.000233, 0.000261,
    0.000288, 0.000313, 0.000336, 0.000356,
    0.000375, 0.000391, 0.000404, 0.000415,
    0.000424, 0.000431, 0.000435, 0.000438,
    0.00044, 0.00044, 0.000438, 0.000435,
    0.000124, 0.000148, 0.000174, 0.0002,
    0.000225, 0.000249, 0.000272, 0.000293,
    0.000313, 0.000331, 0.000346, 0.00036,
    0.000371, 0.000381, 0.000389, 0.000395,
    0.000399, 0.000401, 0.000403, 0.000403,
    0.000401, 0.000104, 0.000126, 0.000149,
    0.000171, 0.000194, 0.000216, 0.000237,
    0.000257, 0.000275, 0.000292, 0.000307,
    0.000321, 0.000332, 0.000342, 0.000351,
    0.000357, 0.000363, 0.000366, 0.000369,
    0.00037, 0.00037, 0.000108, 0.000127,
    0.000147, 0.000168, 0.000187, 0.000207,
    0.000225, 0.000242, 0.000258, 0.000273,
    0.000286, 0.000298, 0.000308, 0.000317,
    0.000324, 0.00033, 0.000334, 0.000337,
    0.00034, 0.000341, 0.000109, 0.000127,
    0.000145, 0.000163, 0.000181, 0.000198,
    0.000214, 0.000229, 0.000243, 0.000255,
    0.000267, 0.000277, 0.000286, 0.000293,
    0.0003, 0.000305, 0.000309, 0.000312,
    0.000314, 0.00011, 0.000126, 0.000142,
    0.000158, 0.000174, 0.000189, 0.000203,
    0.000216, 0.000228, 0.000239, 0.000249,
    0.000258, 0.000266, 0.000272, 0.000278,
    0.000282, 0.000286, 0.000288, 0.00011,
    0.000124, 0.000139, 0.000153, 0.000167,
    0.00018, 0.000192, 0.000204, 0.000215,
    0.000224, 0.000233, 0.000241, 0.000248,
    0.000253, 0.000258, 0.000262, 0.000265,
    0.000109, 0.000122, 0.000135, 0.000148,
    0.00016, 0.000172, 0.000182, 0.000193,
    0.000202, 0.000211, 0.000218, 0.000225,
    0.000231, 0.000236, 0.00024, 0.000244
);

const float freqPhaseOffset[1652] = float[](
    5.056554, 3.969381, 5.080055, 3.602631,
    1.455687, 1.126565, 6.280312, 0.377835,
    4.588601, 4.11208, 2.803668, 5.769827,
    1.989648, 1.205453, 2.817798, 1.781278,
    5.321823, 4.113323, 3.76759, 1.366453,
    6.115189, 3.07693, 1.442377, 4.206799,
    5.677768, 0.310493, 2.16156, 4.580768,
    1.652238, 4.379354, 0.915554, 4.820487,
    0.919467, 4.964641, 0.85966, 4.19354,
    6.167588, 0.072109, 0.290453, 4.806384,
    6.094503, 4.259481, 5.456333, 0.716865,
    1.015797, 4.566258, 6.137082, 1.697453,
    2.045631, 0.687005, 1.644797, 0.299618,
    5.758255, 5.765682, 1.536189, 3.153433,
    0.934452, 1.435869, 2.849387, 1.475698,
    3.603336, 2.035239, 2.020822, 1.93624,
    0.713693, 5.043011, 3.545493, 5.220281,
    4.751649, 3.570356, 0.80778, 2.477805,
    5.300523, 4.087627, 3.123662, 2.92907,
    6.115312, 5.683143, 2.855547, 5.44009,
    5.270778, 2.733378, 2.409564, 3.014235,
    2.21062, 4.11804, 2.22456, 6.002265,
    2.076447, 0.360449, 1.997854, 6.104189,
    1.703586, 5.290294, 2.263307, 0.866843,
    3.38105, 0.132455, 4.775473, 2.630903,
    3.945039, 3.213107, 4.310293, 4.045277,
    5.849965, 3.571301, 1.523814, 3.240415,
    0.46116, 4.636142, 0.769677, 0.700594,
    5.683881, 3.394596, 6.273835, 5.115735,
    0.007443, 3.849349, 3.581424, 2.926499,
    3.907424, 4.688458, 3.821388, 1.483301,
    0.701933, 4.29115, 5.033469, 3.570133,
    4.769578, 1.306875, 4.355655, 2.321027,
    2.226535, 0.89084, 4.482396, 5.450144,
    1.910538, 4.922869, 5.821447, 0.464901,
    1.191148, 5.439601, 4.063833, 0.426376,
    0.590126, 4.918586, 6.259876, 1.193471,
    3.88437, 0.892591, 4.516059, 1.345494,
    2.822464, 4.218654, 2.322081, 0.939488,
    0.957871, 2.81531, 5.142888, 5.615737,
    3.310794, 3.510235, 4.888495, 3.367904,
    1.714136, 3.890931, 1.537562, 1.339546,
    0.07907, 5.827635, 4.964451, 1.530297,
    2.86696, 4.607578, 0.009547, 0.919222,
    3.887615, 2.594217, 2.2761, 2.555537,
    4.813336, 0.084616, 2.881736, 3.666965,
    1.211103, 2.042138, 3.870052, 4.196105,
    4.86792, 3.240627, 2.158211, 3.533657,
    0.774365, 0.85539, 5.294794, 4.389149,
    0.590281, 4.8127, 1.750102, 4.825893,
    3.844789, 5.1232, 6.160947, 6.272078,
    4.553526, 5.470728, 0.996605, 1.885043,
    2.041731, 1.954419, 2.242143, 2.745657,
    5.039547, 4.426155, 2.993395, 2.918927,
    0.651805, 1.847208, 0.818368, 0.177869,
    4.887219, 5.03387, 1.751233, 4.113202,
    0.972423, 4.014438, 0.902713, 4.325718,
    5.863347, 4.351462, 0.800299, 3.822648,
    4.82859, 4.929423, 3.663232, 0.266842,
    4.275572, 0.085235, 2.373012, 0.415609,
    2.861598, 0.767627, 1.599258, 1.942448,
    0.303227, 6.06761, 3.789581, 5.793492,
    0.951776, 1.265285, 3.929102, 3.698466,
    5.614118, 3.586493, 1.465425, 3.895922,
    5.009632, 4.236806, 3.272373, 5.190272,
    0.118997, 1.4475, 2.969136, 1.059478,
    4.742342, 4.828449, 4.8851, 2.39949,
    0.18683, 6.173971, 0.601157, 1.353168,
    0.713491, 2.57795, 5.305772, 0.991594,
    5.164575, 2.216414, 4.667318, 0.898921,
    5.937849, 5.159121, 0.49327, 5.901691,
    6.03796, 2.607673, 1.713014, 3.823001,
    6.259282, 5.230795, 3.568326, 5.68862,
    4.116762, 4.249202, 1.173265, 5.007499,
    0.156273, 6.105166, 4.801563, 1.618771,
    1.044194, 0.056692, 2.675024, 5.327804,
    1.105397, 4.210625, 0.985729, 4.377908,
    3.794815, 3.039323, 3.33115, 1.548834,
    2.759129, 3.640084, 2.920714, 4.989088,
    2.848429, 4.787852, 0.0216, 5.33606,
    0.720019, 4.072317, 0.789852, 0.579048,
    2.600152, 1.580638, 0.69167, 3.32842,
    5.818498, 4.759262, 0.606585, 0.860752,
    2.393267, 3.201837, 1.118046, 5.250633,
    0.036931, 6.276127, 2.31637, 1.749718,
    0.406585, 4.872359, 0.88347, 0.093088,
    4.306354, 2.834027, 0.270269, 2.297225,
    4.733952, 4.835849, 5.008051, 1.816627,
    4.169923, 3.241079, 5.015811, 3.479792,
    4.409459, 4.850844, 1.761802, 6.255011,
    1.297937, 2.415057, 2.511912, 1.656361,
    2.011724, 0.337847, 0.331693, 3.568935,
    2.647895, 5.856742, 1.541746, 5.567055,
    3.379498, 3.557825, 4.186401, 4.798948,
    0.496685, 3.570276, 1.464633, 5.082036,
    1.83735, 4.783177, 3.069039, 4.978298,
    2.440377, 1.395698, 5.347415, 4.238629,
    5.22484, 3.961248, 3.976782, 0.191742,
    0.227912, 3.575301, 5.096219, 2.738381,
    4.483717, 1.005627, 4.245955, 1.724838,
    4.726507, 3.523883, 6.017452, 4.644299,
    2.670945, 4.868755, 2.640384, 3.158312,
    5.308519, 5.034898, 0.01664, 2.440693,
    6.156013, 4.729175, 2.514661, 5.876552,
    5.792247, 5.870663, 2.474615, 0.843077,
    4.277742, 4.691085, 4.215271, 1.200427,
    3.193463, 1.210651, 1.096241, 6.132532,
    3.231255, 3.888353, 4.387562, 2.443895,
    5.944445, 4.84828, 0.612192, 3.109193,
    4.300521, 3.88546, 1.37179, 6.24947,
    5.08643, 4.46978, 4.082649, 5.555065,
    3.910993, 3.339314, 0.440357, 4.19336,
    0.189679, 3.889671, 3.316131, 5.388575,
    1.467851, 2.978098, 0.436867, 6.241172,
    4.330257, 1.722774, 0.431911, 5.765775,
    6.276244, 5.313464, 6.227219, 5.633473,
    5.3957, 0.425427, 2.843932, 3.648561,
    4.192201, 2.243009, 5.668275, 2.555373,
    0.397116, 3.078436, 4.196762, 4.032831,
    1.178222, 3.097197, 0.382179, 2.548784,
    0.548052, 3.126433, 6.068036, 6.069466,
    4.77456, 2.220612, 3.876289, 3.849851,
    3.061948, 2.97911, 0.104133, 6.190771,
    5.479916, 4.803866, 3.853649, 0.403067,
    0.546501, 5.344808, 4.628274, 3.706429,
    4.489319, 1.054958, 2.040885, 3.233724,
    3.027666, 6.011078, 2.503057, 2.71508,
    1.48877, 3.488428, 0.720759, 5.693393,
    5.675289, 4.954621, 0.937718, 3.307151,
    5.219194, 1.728847, 1.248383, 1.366351,
    1.930843, 5.924442, 5.3835, 3.306821,
    1.831454, 5.422483, 5.483005, 3.887942,
    2.212017, 2.039633, 4.718102, 0.8455,
    0.699565, 5.575275, 0.599023, 1.266024,
    1.797516, 0.700282, 5.560035, 1.119519,
    4.772816, 3.526171, 0.760047, 2.451617,
    2.878508, 2.071789, 0.669596, 2.262318,
    3.383312, 5.042687, 5.649707, 0.130703,
    4.229404, 5.010749, 3.071865, 2.592682,
    4.704566, 1.74763, 5.908941, 1.480734,
    5.654648, 3.251785, 1.345265, 1.93739,
    2.724095, 2.051996, 4.186687, 1.19354,
    3.253879, 0.413434, 2.654323, 2.869492,
    2.448177, 0.533096, 5.240428, 5.245829,
    0.19079, 1.542472, 1.821312, 5.149621,
    4.043601, 1.29597, 1.982993, 1.444324,
    2.492833, 2.273744, 4.750223, 5.647472,
    5.375747, 3.682825, 5.596527, 3.334501,
    3.735425, 5.370251, 3.384266, 4.093932,
    5.193881, 2.878325, 4.878788, 2.777238,
    3.433285, 3.081624, 5.077962, 3.624507,
    1.028719, 1.472707, 3.238709, 1.093725,
    2.61724, 2.459185, 1.012113, 5.56057,
    2.108609, 3.358194, 2.676241, 4.91946,
    4.761471, 3.264874, 5.567534, 1.550694,
    4.511228, 3.326181, 0.995142, 1.404897,
    3.540012, 2.924605, 1.598864, 5.274141,
    0.512102, 4.29551, 2.21366, 4.974281,
    4.693201, 1.399128, 4.170557, 5.923651,
    6.223832, 1.604275, 0.440306, 1.526625,
    0.153356, 3.98767, 3.234119, 1.670803,
    4.277535, 5.322523, 6.129366, 1.542427,
    3.878208, 2.1507, 3.470921, 4.006183,
    2.497476, 6.25099, 0.986832, 0.029606,
    0.496083, 3.21748, 4.207918, 2.600833,
    5.692123, 5.478034, 1.028179, 0.245614,
    2.54982, 2.887111, 2.122567, 0.014153,
    2.521999, 0.421286, 0.805538, 0.972703,
    4.432602, 6.109033, 4.105316, 5.189361,
    3.771714, 4.137373, 2.252329, 2.681002,
    1.220339, 3.918101, 4.542345, 5.290025,
    3.381312, 0.194826, 2.237071, 2.47035,
    2.54456, 3.286667, 2.074091, 2.315477,
    1.96933, 1.751902, 5.385069, 5.996903,
    3.65102, 0.406123, 1.739043, 1.108232,
    5.836987, 0.724157, 2.875286, 1.313383,
    5.001122, 3.208543, 4.603915, 4.311417,
    5.600293, 0.087642, 2.190941, 6.165446,
    4.79351, 2.530189, 1.847348, 5.344476,
    2.58985, 1.783465, 5.694057, 1.942913,
    3.50803, 0.173636, 4.685287, 0.79929,
    5.81702, 1.86229, 3.990803, 3.959766,
    5.819367, 3.238965, 4.050458, 3.289629,
    2.843218, 5.908886, 5.478508, 1.856021,
    3.99962, 0.45886, 0.112783, 2.753778,
    6.091546, 5.294771, 2.564786, 3.428864,
    3.222864, 5.186539, 1.365181, 2.440937,
    4.274743, 2.906265, 4.127542, 3.505393,
    4.887409, 0.217105, 1.893014, 5.570352,
    5.534788, 5.723622, 4.627953, 4.298471,
    0.281757, 3.736278, 0.035359, 5.22689,
    1.507413, 0.752077, 1.410472, 0.718972,
    2.422789, 2.524738, 0.869797, 5.541824,
    1.095527, 1.541904, 1.419494, 1.810249,
    6.200923, 0.502945, 5.155373, 3.00155,
    3.942521, 5.054253, 4.675358, 0.827865,
    5.209072, 5.621307, 2.934453, 3.965181,
    1.065471, 4.608964, 0.056115, 2.072117,
    0.942925, 1.146772, 6.008759, 4.690906,
    3.667423, 5.703635, 0.191943, 2.553234,
    3.960881, 4.762155, 4.652727, 1.165601,
    1.289305, 2.722292, 0.29802, 1.491165,
    0.811372, 2.028023, 0.404243, 5.33282,
    0.980995, 2.221137, 2.160057, 2.441984,
    5.652747, 4.16225, 3.450192, 3.68228,
    2.326106, 3.696794, 3.204118, 0.453789,
    3.712454, 5.204944, 1.281895, 5.92499,
    2.667418, 4.345327, 3.556251, 3.811857,
    2.45645, 3.756573, 4.882591, 2.218384,
    0.371074, 1.884773, 6.23761, 1.416247,
    5.599576, 5.395919, 6.186163, 0.039345,
    1.706282, 1.075141, 4.628472, 2.901537,
    0.751695, 0.689767, 1.294319, 3.340754,
    3.625953, 2.691851, 4.551848, 6.14827,
    3.628836, 4.689916, 4.608961, 3.001742,
    5.089752, 1.759005, 2.061019, 0.4383,
    5.848078, 2.167151, 6.245959, 4.526765,
    2.736216, 0.726296, 5.677068, 4.041282,
    5.144653, 4.188498, 2.013577, 0.282164,
    0.281584, 2.095589, 0.097467, 2.990064,
    4.292816, 4.570971, 1.198076, 1.311866,
    5.136054, 6.161972, 3.011192, 0.076725,
    3.407336, 6.223088, 5.389191, 5.84934,
    0.554445, 2.704208, 2.362692, 5.405338,
    6.197592, 0.030494, 4.175707, 3.771286,
    5.169351, 1.408994, 2.935468, 2.120302,
    3.130975, 1.37359, 5.976231, 0.254042,
    0.346022, 5.859529, 6.269708, 1.313927,
    3.805203, 5.103283, 1.095977, 6.100457,
    4.827589, 1.367391, 5.264833, 0.0666,
    3.041508, 0.840475, 3.123771, 4.939805,
    1.37706, 0.972748, 3.312913, 1.364739,
    5.161279, 4.758055, 2.413194, 1.491459,
    6.063788, 4.049742, 0.550113, 0.622868,
    1.89717, 5.108751, 2.558584, 5.530628,
    5.323293, 2.849546, 3.282261, 0.762323,
    5.680321, 5.730662, 3.406262, 5.80443,
    1.492097, 1.708348, 2.47806, 5.979622,
    2.552907, 0.354161, 4.716071, 3.612913,
    5.558898, 0.703021, 4.140825, 4.992933,
    2.223395, 0.896201, 3.185341, 6.188312,
    4.283003, 2.473057, 6.124627, 4.120266,
    0.544123, 2.786428, 3.985684, 4.226367,
    3.369932, 2.323882, 0.122301, 2.841386,
    5.259362, 2.49055, 5.442078, 1.445465,
    5.012862, 1.562994, 2.915004, 5.156313,
    5.071837, 5.276896, 3.405455, 5.68915,
    2.747801, 3.485767, 5.623116, 5.258621,
    0.250682, 2.514209, 4.917803, 6.079374,
    3.155787, 2.810923, 5.516354, 1.801628,
    0.766053, 1.616013, 2.963745, 1.18354,
    1.856972, 0.468468, 5.05359, 5.813974,
    5.258621, 6.022665, 4.57346, 6.247548,
    6.246494, 0.082638, 3.131074, 5.814808,
    0.509176, 0.21325, 5.533384, 4.268543,
    2.551661, 4.492063, 1.020142, 2.854204,
    3.359658, 0.475778, 2.597991, 2.468456,
    5.749141, 5.620406, 3.688345, 2.522057,
    0.087669, 1.575687, 5.667345, 5.684395,
    1.450284, 2.226528, 5.643344, 5.115474,
    5.433972, 4.796266, 0.089439, 4.172363,
    1.884503, 2.83984, 3.829223, 0.233641,
    2.698551, 2.82759, 1.678687, 5.976489,
    1.486363, 5.880941, 6.219128, 1.985576,
    5.535464, 0.043855, 0.284189, 0.902525,
    3.73436, 2.917414, 3.179475, 1.286528,
    4.919991, 1.119683, 0.978601, 2.531143,
    5.513288, 5.333351, 4.713065, 0.248374,
    1.266396, 0.692206, 0.904233, 5.370551,
    0.826831, 4.952284, 0.017427, 0.621382,
    0.959603, 2.573361, 1.784874, 5.884164,
    5.519703, 1.986324, 0.393996, 1.633995,
    5.256225, 1.518055, 5.342036, 1.52416,
    2.553762, 5.623499, 5.772934, 3.069763,
    0.440567, 4.577904, 5.904529, 3.901357,
    0.976005, 1.356359, 5.282338, 0.896306,
    1.893459, 5.940174, 5.967002, 2.545358,
    4.821095, 2.370861, 4.222659, 2.982518,
    5.127203, 6.052358, 6.258682, 0.546246,
    0.073084, 1.286291, 0.080332, 0.635383,
    0.635732, 1.92174, 1.360091, 1.020105,
    4.178162, 2.175311, 3.76475, 6.077887,
    0.452328, 3.221412, 5.503121, 6.237615,
    2.79647, 3.454857, 0.604952, 1.952511,
    2.863751, 6.262581, 5.59952, 4.599974,
    2.354156, 4.253932, 5.812365, 5.143751,
    3.766098, 5.661812, 2.761012, 1.24242,
    2.332108, 3.839445, 0.913015, 5.742858,
    4.591816, 0.569867, 0.405603, 2.637445,
    0.138933, 4.844305, 3.758038, 0.921497,
    4.774612, 5.169332, 1.709781, 3.85044,
    1.536818, 0.247155, 4.820084, 2.421428,
    1.236266, 3.118373, 2.648556, 0.929762,
    3.590658, 4.530818, 3.914112, 2.429847,
    2.754779, 3.413235, 5.376006, 2.067831,
    1.440371, 1.266261, 2.14465, 1.05464,
    3.08158, 4.614333, 0.162528, 4.25923,
    1.07606, 2.185684, 4.504626, 5.848789,
    3.692247, 0.460284, 5.345947, 2.870886,
    4.120782, 2.266469, 1.574225, 4.670751,
    5.940889, 1.693017, 6.276788, 1.102432,
    1.142851, 6.092464, 0.429856, 3.016785,
    4.304633, 5.367759, 5.337731, 0.404615,
    3.335624, 0.204972, 0.896086, 2.560524,
    0.703007, 2.188057, 0.180629, 2.532098,
    0.763194, 5.745714, 0.541112, 3.227304,
    1.841521, 2.24777, 2.344216, 1.189989,
    1.851693, 0.16153, 4.354764, 0.634233,
    0.689917, 5.514147, 0.759454, 6.047101,
    2.461232, 1.646088, 3.174064, 2.073879,
    5.604181, 2.923368, 2.497466, 3.048885,
    2.259921, 0.989873, 3.352102, 5.795766,
    1.81136, 0.101897, 2.488352, 1.966537,
    1.281639, 0.172603, 5.232428, 0.337898,
    3.34096, 1.829501, 3.477372, 1.790309,
    0.332424, 0.887459, 5.800691, 3.480971,
    2.590408, 0.412532, 4.149899, 1.849153,
    2.940125, 5.908005, 3.171083, 0.734258,
    5.387344, 1.275828, 4.813977, 5.647676,
    4.084429, 6.126813, 2.576635, 2.335609,
    4.165579, 3.652155, 3.455657, 0.329679,
    5.447353, 4.432422, 0.668656, 2.711705,
    1.191047, 0.537015, 4.872919, 1.34304,
    2.467133, 0.631104, 4.888919, 4.977011,
    4.36918, 5.088074, 0.20148, 3.37869,
    4.411178, 3.327514, 4.654911, 2.589148,
    5.61681, 4.181095, 1.03062, 5.171257,
    0.63463, 3.193773, 5.956782, 1.216499,
    5.956435, 5.108403, 3.65683, 6.068622,
    5.030149, 3.860355, 2.926296, 5.066034,
    5.500686, 4.111652, 3.498929, 0.363881,
    0.007805, 2.946952, 0.733585, 1.815458,
    5.21289, 1.772851, 6.197549, 2.346194,
    0.8775, 2.973109, 2.28555, 4.028676,
    4.650306, 5.786928, 3.776787, 6.124559,
    6.000421, 5.640011, 1.289464, 2.416362,
    2.943585, 3.951134, 0.652799, 4.634219,
    5.92031, 0.438262, 3.528252, 2.812853,
    3.092758, 5.602711, 4.789347, 6.280662,
    3.956852, 4.100984, 1.673759, 0.775508,
    3.557562, 1.334477, 3.17009, 1.996846,
    5.985166, 2.639177, 4.652151, 1.58245,
    2.340044, 4.039329, 3.908455, 0.256145,
    5.047568, 5.525918, 5.917367, 2.809643,
    0.505277, 1.439613, 5.716532, 3.476331,
    4.740357, 4.517017, 3.798857, 4.747238,
    1.117453, 1.967599, 2.375835, 4.374668,
    1.79183, 0.929555, 4.432726, 3.545822,
    3.894214, 3.743826, 6.024398, 4.632447,
    3.691848, 6.261242, 1.769298, 0.978056,
    4.954023, 2.984317, 1.114044, 0.385688,
    2.349009, 6.19275, 0.77353, 5.960433,
    3.484744, 4.581606, 1.104611, 4.272487,
    4.829707, 5.719497, 5.607426, 2.407727,
    3.697487, 3.372005, 4.677316, 0.816419,
    3.689826, 5.407407, 3.608835, 1.816832,
    1.684687, 4.676515, 2.426799, 2.118827,
    3.442118, 1.962549, 3.497465, 2.882412,
    1.533675, 2.767566, 2.41982, 2.714486,
    1.517176, 3.157495, 1.452986, 5.40976,
    3.683687, 2.669118, 0.549334, 0.1616,
    3.095612, 0.743893, 3.806008, 0.076984,
    1.68749, 3.420863, 1.805859, 3.87457,
    6.192079, 3.2046, 3.056538, 6.148822,
    1.820404, 2.978572, 3.864828, 4.10028,
    0.117226, 4.843491, 0.590306, 4.767019,
    3.637978, 1.833425, 4.31091, 4.055269,
    5.142524, 0.58765, 0.150139, 1.851712,
    1.465234, 4.317214, 2.213506, 5.604113,
    2.452984, 2.512415, 1.607835, 0.294809,
    2.255667, 5.172891, 1.728145, 1.66984,
    4.517001, 0.943991, 0.220862, 2.442425,
    5.213209, 3.564445, 3.92169, 5.717215,
    2.433989, 5.184304, 0.115464, 4.467817,
    0.695058, 2.734862, 0.913257, 4.782286,
    4.331135, 0.346206, 1.253163, 2.484254,
    1.941105, 3.120837, 2.470654, 2.741391,
    2.691999, 5.089624, 2.593832, 4.449747,
    0.961755, 0.828497, 1.543322, 3.147749,
    3.223663, 0.982968, 0.390759, 4.871618,
    2.878651, 2.851235, 4.175869, 4.699075,
    3.76315, 0.718892, 1.550521, 4.662401,
    1.2798, 4.117251, 2.831744, 1.400289,
    2.843737, 1.949283, 2.211902, 5.166492,
    2.385124, 5.216413, 3.107537, 0.202002,
    3.193567, 1.966269, 4.081896, 1.081138,
    3.164136, 0.379751, 2.146855, 1.59292,
    5.147086, 3.174627, 2.106401, 5.589285,
    0.683728, 4.792972, 1.801801, 0.501867,
    5.102734, 3.233381, 5.091419, 1.964908,
    5.54269, 0.654113, 0.416886, 3.933973,
    2.537973, 3.714111, 3.83248, 4.674984,
    2.230997, 5.490861, 1.454148, 0.450624,
    3.257168, 3.924452, 5.570319, 5.423052,
    5.957202, 1.439246, 2.517284, 4.032461,
    5.912013, 3.561469, 0.864692, 2.763965,
    3.928448, 2.529719, 5.400755, 4.117467,
    3.960887, 6.200941, 3.244089, 3.375885,
    4.25748, 2.130462, 3.011265, 5.970786,
    1.083011, 5.532112, 2.275862, 2.072882,
    4.046137, 2.672812, 3.191605, 4.478751,
    1.149073, 1.703736, 3.672038, 4.378795,
    3.319261, 1.795066, 4.376857, 0.850904,
    2.872324, 0.493685, 0.86694, 3.16836,
    6.126497, 1.825664, 2.735831, 3.729889,
    4.19002, 2.355749, 3.277001, 5.825868,
    3.194133, 1.211677, 3.986205, 2.924082,
    3.995919, 2.459835, 0.490672, 2.17507,
    1.771647, 1.264393, 1.929549, 6.052604,
    5.555505, 4.997515, 4.958603, 1.794532,
    2.487586, 3.843999, 1.260988, 1.516571,
    6.069306, 6.161127, 2.313542, 4.023822,
    1.245617, 2.6614, 2.957376, 0.742716
);



float computeHeightFromIFFT(vec2 pos, float t) {
    float height = 0.0;
    // h(x) = sum_k (A_k * exp(i*(freqDirx - omega_k*t + phase_k)))
    for (int i=0; i<freqCount; i++) {
        float phase = dot(freqDir[i], pos) * freqOmega[i] - freqOmega[i]*t + freqPhaseOffset[i];
        height += freqAmp[i]*sin(phase);
    }
    return height;
}

void computeNormalFromHeight(vec2 pos, float t, out float H, out vec3 N) {
    float epsilon = 0.001;
    float H0 = computeHeightFromIFFT(pos, t);
    float Hx = (computeHeightFromIFFT(pos + vec2(epsilon,0), t) - computeHeightFromIFFT(pos - vec2(epsilon,0), t)) / (2.0*epsilon);
    float Hz = (computeHeightFromIFFT(pos + vec2(0,epsilon), t) - computeHeightFromIFFT(pos - vec2(0,epsilon), t)) / (2.0*epsilon);
    H = H0;
    N = normalize(vec3(-Hx, 1.0, -Hz));
}

vec4 renderDynamicSea(vec3 cameraPosition, vec3 worldPosition, float depth)
{
    vec3 viewDirection = normalize(worldPosition - cameraPosition);
    vec3 boxMin = vec3(-sea_width, sea_bottom, -sea_width);
    vec3 boxMax = vec3(sea_width, sea_top, sea_width);
    float tnear = intersectionAABB(boxMin, boxMax, cameraPosition, viewDirection).x;
    if (abs(tnear - -1.0f) < 1e-8f || (depth > 0.0f && tnear > depth)) {
        return vec4(0.0f);
    }
    vec3 point = cameraPosition + viewDirection * max(tnear, 0.0);

    vec2 pos = vec2(point.x, point.z);
    float time = float(frameCounter)*0.05; // dynamic time

    float H;
    vec3 normal;
    computeNormalFromHeight(pos, time, H, normal);

    float diffuse;

    // compute shadow from mesh
    vec3 rayToLight = normalize(lightPos - point);
    mat4 mat = mat4(1.0f);
    mat[3] = vec4(meshTrans, 1.0f);
    vec3 origin = (inverse(mat) * vec4(point, 1.0f)).xyz;
    vec3 direction = (inverse(mat) * vec4(rayToLight, 0.0f)).xyz;
    vec2 intersectionToLight = intersectionKDTree(origin, direction);
    if (intersectionToLight.x > 0.0f) {
        diffuse = 0.0f;
    }
    else {
        diffuse = max(dot(normal, normalize(lightPos - point)), 0.0);
    }

    vec3 baseColor = vec3(0.4, 0.6, 0.8); // sea color
    vec4 dynamicSeaColor = vec4(baseColor * diffuse, 1.0);

    // compute reflection on the water
    vec3 reflectionRay = reflect(viewDirection, normal);
    reflectionRay = (inverse(mat) * vec4(reflectionRay, 0.0f)).xyz;
    vec4 reflectionColor = calculateRGB(origin, reflectionRay);

    dynamicSeaColor = mix(dynamicSeaColor, reflectionColor, 0.5f);

    return dynamicSeaColor;
}

void main()
{
    vec4 color = vec4(0.0f);
    mat4 mat = mat4(1.0f);
    mat[3] = vec4(meshTrans, 1.0f);
    vec3 origin = (inverse(mat) * vec4(rayOrigin, 1.0f)).xyz;
    vec3 direction = (inverse(mat) * vec4(rayDirection, 0.0f)).xyz;
    vec2 ret = intersectionKDTree(origin, direction);
    // vec2 ret = intersectionKDTree(rayOrigin, rayDirection);
    int idx = int(round(ret.x));
    float t = ret.y;
    vec4 dynamicSeaColor = renderDynamicSea(rayOrigin,  rayOrigin + rayDirection * 1000, t);
    if (idx < 0) {
        outColor = mix(vec4(0.529f, 0.808f, 0.922f, 1.0f), dynamicSeaColor, dynamicSeaColor.a);
        outDistance = -1.0f;
    }
    else {
        mesh m = getMesh(idx);
        vec3 worldPosition = rayOrigin + t * rayDirection;
        color = vec4(m.diffuseColor * max(dot(normalize(lightPos - worldPosition), m.faceNormal), 0.0f), 1.0f);
        outColor = color;
        outDistance = t;
    }
    // else {   // only intersection
    //     return vec4(1.0f);
    // }
}
